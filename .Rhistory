ggplot(aes(x = variable, y = p)) +
geom_point(aes(color = model), position = "jitter") +
coord_flip() +
geom_linerange(aes(ymin = lb, ymax = ub, color = model)))
effects1
#Effect Size Plot
(effects1 <- effects.data %>%
ggplot(aes(x = variable, y = p)) +
geom_point(aes(color = model)) +
coord_flip() +
coord_fixed() +
geom_linerange(aes(ymin = lb, ymax = ub, color = model)))
#Effect Size Plot
(effects1 <- effects.data %>%
ggplot(aes(x = variable, y = p)) +
geom_point(aes(color = model)) +
coord_fixed() +
geom_linerange(aes(ymin = lb, ymax = ub, color = model)))
#Effect Size Plot
(effects1 <- effects.data %>%
ggplot(aes(x = variable, y = p)) +
geom_point(aes(color = model)) +
coord_fixed() +
coord_flip() +
geom_linerange(aes(ymin = lb, ymax = ub, color = model)))
#Effect Size Plot
(effects1 <- effects.data %>%
ggplot(aes(x = variable, y = p)) +
geom_point(aes(color = model)) +
geom_linerange(aes(ymin = lb, ymax = ub, color = model)) +
coord_fixed() +
coord_flip())
#Tidying Models
m1 <- tidy(model) %>%
mutate(p = exp(estimate),
lb = exp(lower),
ub = exp(upper)) %>%
mutate(variable = case_when(
term == "b_Intercept" ~ "Intercept",
term == "b_age" ~ "Age",
term == "b_female" ~ "Sex",
term == "b_family.income" ~ "Family Income",
term == "b_weapon.carry" ~ "Weapon Carry",
term == "b_racial.heterogeneity" ~ "Racial Heterogeneity",
term == "b_network.delinquency" ~ "Network Delinquency",
term == "b_popularity" ~ "Popularity",
term == "b_centrality" ~ "Centrality",
term == "b_density" ~ "Density",
T ~ NA_character_)) %>%
mutate(model = "Model 1") %>%
select(variable, p, lb, ub, model)
m2 <- tidy(imodel1) %>%
mutate(p = exp(estimate),
lb = exp(lower),
ub = exp(upper)) %>%
mutate(variable = case_when(
term == "b_Intercept" ~ "Intercept",
term == "b_age" ~ "Age",
term == "b_female" ~ "Sex",
term == "b_family.income" ~ "Family Income",
term == "b_weapon.carry" ~ "Weapon Carry",
term == "b_racial.heterogeneity" ~ "Racial Heterogeneity",
term == "b_network.delinquency" ~ "Network Delinquency",
term == "b_popularity" ~ "Popularity",
term == "b_centrality" ~ "Centrality",
term == "b_density" ~ "Density",
term == "b_network.delinquency:centrality" ~ "Delinquency*Centrality",
T ~ NA_character_)) %>%
mutate(model = "Model 2") %>%
select(variable, p, lb, ub, model)
m3 <- tidy(imodel2) %>%
mutate(p = exp(estimate),
lb = exp(lower),
ub = exp(upper)) %>%
mutate(variable = case_when(
term == "b_Intercept" ~ "Intercept",
term == "b_age" ~ "Age",
term == "b_female" ~ "Sex",
term == "b_family.income" ~ "Family Income",
term == "b_weapon.carry" ~ "Weapon Carry",
term == "b_racial.heterogeneity" ~ "Racial Heterogeneity",
term == "b_network.delinquency" ~ "Network Delinquency",
term == "b_popularity" ~ "Popularity",
term == "b_centrality" ~ "Centrality",
term == "b_density" ~ "Density",
term == "b_network.delinquency:popularity" ~ "Delinquency*Popularity",
T ~ NA_character_)) %>%
mutate(model = "Model 3") %>%
select(variable, p, lb, ub, model)
m4 <- tidy(imodel3) %>%
mutate(p = exp(estimate),
lb = exp(lower),
ub = exp(upper)) %>%
mutate(variable = case_when(
term == "b_Intercept" ~ "Intercept",
term == "b_age" ~ "Age",
term == "b_female" ~ "Sex",
term == "b_family.income" ~ "Family Income",
term == "b_weapon.carry" ~ "Weapon Carry",
term == "b_racial.heterogeneity" ~ "Racial Heterogeneity",
term == "b_network.delinquency" ~ "Network Delinquency",
term == "b_popularity" ~ "Popularity",
term == "b_centrality" ~ "Centrality",
term == "b_density" ~ "Density",
term == "b_network.delinquency:density" ~ "Delinquency*Density",
T ~ NA_character_)) %>%
mutate(model = "Model 4") %>%
select(variable, p, lb, ub, model)
m1 <- m1[complete.cases(m1), ]
m2 <- m2[complete.cases(m2), ]
m3 <- m3[complete.cases(m3), ]
m4 <- m4[complete.cases(m4), ]
effects.data <- rbind(m1, m2, m3, m4)
#Effect Size Plot
(effects1 <- effects.data %>%
ggplot(aes(x = variable, y = p)) +
geom_point(aes(color = model)) +
geom_linerange(aes(ymin = lb, ymax = ub, color = model)) +
coord_flip())
#Effect Size Plot
(effects1 <- effects.data %>%
ggplot(aes(x = variable, y = p)) +
geom_point(aes(color = model)) +
geom_linerange(aes(ymin = lb, ymax = ub, color = model)) +
coord_flip())
a <- dwplot(list(m1, m2, m3, m4),
vline = geom_vline(xintercept = 0, colour = "grey60", linetype = 2)) %>%
theme_bw() + xlab("Coefficient Estimate") + ylab("") +
geom_vline(xintercept = 0, colour = "grey60", linetype = 2) +
ggtitle(" ") +
theme(plot.title = element_text(face="bold"),
legend.position = c(0.007, 0.01),
legend.justification = c(0, 0),
legend.background = element_rect(colour="grey80"),
legend.title = element_blank())
a <- dwplot(list(m1, m2, m3, m4),
vline = geom_vline(xintercept = 0, colour = "grey60", linetype = 2)) +
theme_bw() + xlab("Coefficient Estimate") + ylab("") +
geom_vline(xintercept = 0, colour = "grey60", linetype = 2) +
ggtitle(" ") +
theme(plot.title = element_text(face="bold"),
legend.position = c(0.007, 0.01),
legend.justification = c(0, 0),
legend.background = element_rect(colour="grey80"),
legend.title = element_blank())
a <- dwplot(list(m1, m2, m3, m4),
a
a
a
a <- dwplot(list(m1, m2, m3, m4),
vline = geom_vline(xintercept = 0, colour = "grey60", linetype = 2))
a <- dwplot(effects.data,
vline = geom_vline(xintercept = 0, colour = "grey60", linetype = 2)) +
theme_bw() + xlab("Coefficient Estimate") + ylab("") +
geom_vline(xintercept = 0, colour = "grey60", linetype = 2) +
ggtitle(" ") +
theme(plot.title = element_text(face="bold"),
legend.position = c(0.007, 0.01),
legend.justification = c(0, 0),
legend.background = element_rect(colour="grey80"),
legend.title = element_blank())
dwplot(imodel1)
a <- imodel1 %>%
tidy() %>%
dwplot()
a
m1 <- tidy(model) %>%
mutate(variable = case_when(
term == "b_Intercept" ~ "Intercept",
term == "b_age" ~ "Age",
term == "b_female" ~ "Sex",
term == "b_family.income" ~ "Family Income",
term == "b_weapon.carry" ~ "Weapon Carry",
term == "b_racial.heterogeneity" ~ "Racial Heterogeneity",
term == "b_network.delinquency" ~ "Network Delinquency",
term == "b_popularity" ~ "Popularity",
term == "b_centrality" ~ "Centrality",
term == "b_density" ~ "Density",
T ~ NA_character_)) %>%
select(variable, estimate, lower, upper)
m1 <- m1[complete.cases(m1), ]
(a <- m1 %>%
dwplot())
(a <- model %>%
dwplot())
a <- dwplot(list(model, imodel1, imodel2, imodel3),
vline = geom_vline(xintercept = 0, colour = "grey60", linetype = 2)) +
theme_bw() + xlab("Coefficient Estimate") + ylab("") +
geom_vline(xintercept = 0, colour = "grey60", linetype = 2) +
ggtitle(" ") +
theme(plot.title = element_text(face="bold"),
legend.position = c(0.007, 0.01),
legend.justification = c(0, 0),
legend.background = element_rect(colour="grey80"),
legend.title = element_blank())
install.packages("GGally")
library(GGally)
(a <- model %>%
ggcoeff())
ggcoef(model)
m1 <- tidy(model) %>%
mutate(variable = case_when(
term == "b_Intercept" ~ "Intercept",
term == "b_age" ~ "Age",
term == "b_female" ~ "Sex",
term == "b_family.income" ~ "Family Income",
term == "b_weapon.carry" ~ "Weapon Carry",
term == "b_racial.heterogeneity" ~ "Racial Heterogeneity",
term == "b_network.delinquency" ~ "Network Delinquency",
term == "b_popularity" ~ "Popularity",
term == "b_centrality" ~ "Centrality",
term == "b_density" ~ "Density",
T ~ NA_character_)) %>%
select(variable, estimate, lower, upper)
m1 <- m1[complete.cases(m1), ]
ggcoef(m1)
m1 <- tidy(model) %>%
mutate(term = case_when(
term == "b_Intercept" ~ "Intercept",
term == "b_age" ~ "Age",
term == "b_female" ~ "Sex",
term == "b_family.income" ~ "Family Income",
term == "b_weapon.carry" ~ "Weapon Carry",
term == "b_racial.heterogeneity" ~ "Racial Heterogeneity",
term == "b_network.delinquency" ~ "Network Delinquency",
term == "b_popularity" ~ "Popularity",
term == "b_centrality" ~ "Centrality",
term == "b_density" ~ "Density",
T ~ NA_character_)) %>%
select(variable, estimate, lower, upper)
term == "b_Intercept" ~ "Intercept",
m1 <- tidy(model) %>%
mutate(term = case_when(
term == "b_Intercept" ~ "Intercept",
term == "b_age" ~ "Age",
term == "b_female" ~ "Sex",
term == "b_family.income" ~ "Family Income",
term == "b_weapon.carry" ~ "Weapon Carry",
term == "b_racial.heterogeneity" ~ "Racial Heterogeneity",
term == "b_network.delinquency" ~ "Network Delinquency",
term == "b_popularity" ~ "Popularity",
term == "b_centrality" ~ "Centrality",
term == "b_density" ~ "Density",
T ~ NA_character_)) %>%
select(term, estimate, lower, upper)
m1 <- m1[complete.cases(m1), ]
ggcoef(m1)
m2 <- tidy(imodel1) %>%
#mutate(p = exp(estimate),
#lb = exp(lower),
#ub = exp(upper)) %>%
mutate(term = case_when(
term == "b_Intercept" ~ "Intercept",
term == "b_age" ~ "Age",
term == "b_female" ~ "Sex",
term == "b_family.income" ~ "Family Income",
term == "b_weapon.carry" ~ "Weapon Carry",
term == "b_racial.heterogeneity" ~ "Racial Heterogeneity",
term == "b_network.delinquency" ~ "Network Delinquency",
term == "b_popularity" ~ "Popularity",
term == "b_centrality" ~ "Centrality",
term == "b_density" ~ "Density",
term == "b_network.delinquency:centrality" ~ "Delinquency*Centrality",
T ~ NA_character_)) %>%
mutate(model = "Model 2") %>%
select(term, p, lb, ub, model)
term == "b_Intercept" ~ "Intercept",
m3 <- tidy(imodel2) %>%
mutate(p = exp(estimate),
lb = exp(lower),
ub = exp(upper)) %>%
mutate(variable = case_when(
term == "b_Intercept" ~ "Intercept",
term == "b_age" ~ "Age",
term == "b_female" ~ "Sex",
term == "b_family.income" ~ "Family Income",
term == "b_weapon.carry" ~ "Weapon Carry",
term == "b_racial.heterogeneity" ~ "Racial Heterogeneity",
term == "b_network.delinquency" ~ "Network Delinquency",
term == "b_popularity" ~ "Popularity",
term == "b_centrality" ~ "Centrality",
term == "b_density" ~ "Density",
term == "b_network.delinquency:popularity" ~ "Delinquency*Popularity",
T ~ NA_character_)) %>%
mutate(model = "Model 3") %>%
select(variable, p, lb, ub, model)
m2 <- tidy(imodel1) %>%
#mutate(p = exp(estimate),
#lb = exp(lower),
#ub = exp(upper)) %>%
mutate(term = case_when(
term == "b_Intercept" ~ "Intercept",
term == "b_age" ~ "Age",
term == "b_female" ~ "Sex",
term == "b_family.income" ~ "Family Income",
term == "b_weapon.carry" ~ "Weapon Carry",
term == "b_racial.heterogeneity" ~ "Racial Heterogeneity",
term == "b_network.delinquency" ~ "Network Delinquency",
term == "b_popularity" ~ "Popularity",
term == "b_centrality" ~ "Centrality",
term == "b_density" ~ "Density",
term == "b_network.delinquency:centrality" ~ "Delinquency*Centrality",
T ~ NA_character_)) %>%
mutate(model = "Model 2") %>%
select(term, estimate, lower, upper)
m1 <- m1[complete.cases(m1), ]
m2 <- m2[complete.cases(m2), ]
m3 <- m3[complete.cases(m3), ]
ggcoef(m1\2)
ggcoef(m2)
m1 <- tidy(model) %>%
mutate(term = case_when(
term == "b_Intercept" ~ "Intercept",
term == "b_age" ~ "Age",
term == "b_female" ~ "Sex",
term == "b_family.income" ~ "Family Income",
term == "b_weapon.carry" ~ "Weapon Carry",
term == "b_racial.heterogeneity" ~ "Racial Heterogeneity",
term == "b_network.delinquency" ~ "Network Delinquency",
term == "b_popularity" ~ "Popularity",
term == "b_centrality" ~ "Centrality",
term == "b_density" ~ "Density",
T ~ NA_character_)) %>%
select(term, estimate)
m1 <- m1[complete.cases(m1), ]
ggcoef(m1)
ggcoef(m1, mapping = aes_string(y = "term", x = "estimate"), conf.int = TRUE,
conf.level = 0.95, exponentiate = T, exclude_intercept = F,
vline = T, vline_intercept = "auto", vline_color = "gray50",
vline_linetype = "dotted", vline_size = 1, errorbar_color = "seagreen",
errorbar_height = 0, errorbar_linetype = "solid", errorbar_size = 0.5,
sort = "ascending")
ggcoef(m1, mapping = aes_string(y = "term", x = "estimate"), conf.int = TRUE,
conf.level = 0.95, exponentiate = F, exclude_intercept = F,
vline = T, vline_intercept = "auto", vline_color = "gray50",
vline_linetype = "dotted", vline_size = 1, errorbar_color = "seagreen",
errorbar_height = 0, errorbar_linetype = "solid", errorbar_size = 0.5,
sort = "ascending")
m1 <- tidy(model) %>%
mutate(term = case_when(
term == "b_Intercept" ~ "Intercept",
term == "b_age" ~ "Age",
term == "b_female" ~ "Sex",
term == "b_family.income" ~ "Family Income",
term == "b_weapon.carry" ~ "Weapon Carry",
term == "b_racial.heterogeneity" ~ "Racial Heterogeneity",
term == "b_network.delinquency" ~ "Network Delinquency",
term == "b_popularity" ~ "Popularity",
term == "b_centrality" ~ "Centrality",
term == "b_density" ~ "Density",
T ~ NA_character_)) %>%
select(term, estimate, lower, upper)
m1 <- m1[complete.cases(m1), ]
ggcoef(m1, mapping = aes_string(y = "term", x = "estimate"), conf.int = TRUE,
conf.level = 0.95, exponentiate = F, exclude_intercept = F,
vline = T, vline_intercept = "auto", vline_color = "gray50",
vline_linetype = "dotted", vline_size = 1, errorbar_color = "seagreen",
errorbar_height = 0, errorbar_linetype = "solid", errorbar_size = 0.5,
sort = "ascending")
ggcoef(m1, mapping = aes_string(y = "term", x = "estimate"), conf.int = TRUE,
conf.level = 0.95, exponentiate = F, exclude_intercept = F,
vline = T, vline_intercept = "auto", vline_color = "gray50",
vline_linetype = "dotted", vline_size = 1, errorbar_color = "seagreen",
errorbar_height = 1, errorbar_linetype = "solid", errorbar_size = 0.5,
sort = "ascending")
ggcoef(m1, mapping = aes_string(y = "term", x = "estimate"), conf.int = TRUE,
conf.level = 0.95, exponentiate = F, exclude_intercept = F,
vline = T, vline_intercept = "auto", vline_color = "gray50",
vline_linetype = "dotted", vline_size = 1, errorbar_color = "seagreen", errorbar_linetype = "solid", errorbar_size = 0.5, sort = "ascending")
model
View(model)
m1 <- tidy(model)
m1 <- tidy(model) %>%
mutate(term = case_when(
term == "b_Intercept" ~ "Intercept",
term == "b_age" ~ "Age",
term == "b_female" ~ "Sex",
term == "b_family.income" ~ "Family Income",
term == "b_weapon.carry" ~ "Weapon Carry",
term == "b_racial.heterogeneity" ~ "Racial Heterogeneity",
term == "b_network.delinquency" ~ "Network Delinquency",
term == "b_popularity" ~ "Popularity",
term == "b_centrality" ~ "Centrality",
term == "b_density" ~ "Density",
T ~ NA_character_)) %>%
select(term, estimate, lower, upper)
m1 <- m1[complete.cases(m1), ]
ggcoef(m1, mapping = aes_string(y = "term", x = "estimate"), conf.int = TRUE,
conf.level = 0.95, exponentiate = T, exclude_intercept = F,
vline = T, vline_intercept = "auto", vline_color = "gray50",
vline_linetype = "dotted", vline_size = 1, errorbar_color = "seagreen", errorbar_linetype = "solid", errorbar_size = 0.5, sort = "ascending")
ggcoef(m1, mapping = aes_string(y = "term", x = "estimate"), conf.int = TRUE,
conf.level = 0.95, exponentiate = F, exclude_intercept = F,
vline = T, vline_intercept = 1,
vline_linetype = "dotted", vline_size = 1, errorbar_color = "seagreen", errorbar_linetype = "solid", errorbar_size = 10, sort = "ascending")
ggcoef(m1, mapping = aes_string(y = "term", x = "estimate"), conf.int = TRUE,
conf.level = 0.95, exponentiate = F, exclude_intercept = F,
vline = T, vline_intercept = 1,
vline_linetype = "dotted", vline_size = 1, errorbar_color = "seagreen", errorbar_size = 10, sort = "ascending")
ggcoef(m1, mapping = aes_string(y = "term", x = "estimate"), conf.int = TRUE,
conf.level = 0.95, exponentiate = F, exclude_intercept = F,
vline = T, vline_intercept = 1,
vline_linetype = "dotted", vline_size = 1, errorbar_color = "seagreen", sort = "ascending")
ggcoef(m1, mapping = aes_string(y = "term", x = "estimate"), conf.int = TRUE,
conf.level = 0.95, exponentiate = F, exclude_intercept = F,
vline = T, vline_intercept = 1,
vline_linetype = "dotted", vline_size = 4, errorbar_color = "seagreen", sort = "ascending")
ggcoef(m1, mapping = aes_string(y = "term", x = "estimate"), conf.int = TRUE,
conf.level = 0.95, exponentiate = F, exclude_intercept = F,
vline = T, vline_intercept = 1,
vline_linetype = "dotted", vline_size = 1, errorbar_color = "seagreen", sort = "ascending")
ggcoef(m1, mapping = aes_string(y = "term", x = "estimate"), conf.int = F,
conf.level = 0.95, exponentiate = F, exclude_intercept = F,
vline = T, vline_intercept = 1,
vline_linetype = "dotted", vline_size = 1, errorbar_color = "seagreen", sort = "ascending")
ggcoef(m1, mapping = aes_string(y = "term", x = "estimate"),
conf.level = 0.95, exponentiate = F, exclude_intercept = F,
vline = T, vline_intercept = 1,
vline_linetype = "dotted", vline_size = 1, errorbar_color = "seagreen", sort = "ascending")
#Tidying Models
m1 <- tidy(model) %>%
mutate(estimate = exp(estimate),
lower = exp(lower),
upper = exp(upper)) %>%
mutate(term = case_when(
term == "b_Intercept" ~ "Intercept",
term == "b_age" ~ "Age",
term == "b_female" ~ "Sex",
term == "b_family.income" ~ "Family Income",
term == "b_weapon.carry" ~ "Weapon Carry",
term == "b_racial.heterogeneity" ~ "Racial Heterogeneity",
term == "b_network.delinquency" ~ "Network Delinquency",
term == "b_popularity" ~ "Popularity",
term == "b_centrality" ~ "Centrality",
term == "b_density" ~ "Density",
T ~ NA_character_)) %>%
mutate(model = "Model 1") %>%
select(term, estimate, lower, upper, model)
m2 <- tidy(imodel1) %>%
mutate(estimate = exp(estimate),
lower = exp(lower),
upper = exp(upper)) %>%
mutate(term = case_when(
term == "b_Intercept" ~ "Intercept",
term == "b_age" ~ "Age",
term == "b_female" ~ "Sex",
term == "b_family.income" ~ "Family Income",
term == "b_weapon.carry" ~ "Weapon Carry",
term == "b_racial.heterogeneity" ~ "Racial Heterogeneity",
term == "b_network.delinquency" ~ "Network Delinquency",
term == "b_popularity" ~ "Popularity",
term == "b_centrality" ~ "Centrality",
term == "b_density" ~ "Density",
term == "b_network.delinquency:centrality" ~ "Delinquency*Centrality",
T ~ NA_character_)) %>%
mutate(model = "Model 2") %>%
select(term, estimate, lower, upper)
m3 <- tidy(imodel2) %>%
mutate(estimate = exp(estimate),
lower = exp(lower),
upper = exp(upper)) %>%
mutate(term = case_when(
term == "b_Intercept" ~ "Intercept",
term == "b_age" ~ "Age",
term == "b_female" ~ "Sex",
term == "b_family.income" ~ "Family Income",
term == "b_weapon.carry" ~ "Weapon Carry",
term == "b_racial.heterogeneity" ~ "Racial Heterogeneity",
term == "b_network.delinquency" ~ "Network Delinquency",
term == "b_popularity" ~ "Popularity",
term == "b_centrality" ~ "Centrality",
term == "b_density" ~ "Density",
term == "b_network.delinquency:popularity" ~ "Delinquency*Popularity",
T ~ NA_character_)) %>%
mutate(model = "Model 3") %>%
select(term, estimate, lower, upper, model)
m4 <- tidy(imodel3) %>%
mutate(estimate = exp(estimate),
lower = exp(lower),
upper = exp(upper)) %>%
mutate(term = case_when(
term == "b_Intercept" ~ "Intercept",
term == "b_age" ~ "Age",
term == "b_female" ~ "Sex",
term == "b_family.income" ~ "Family Income",
term == "b_weapon.carry" ~ "Weapon Carry",
term == "b_racial.heterogeneity" ~ "Racial Heterogeneity",
term == "b_network.delinquency" ~ "Network Delinquency",
term == "b_popularity" ~ "Popularity",
term == "b_centrality" ~ "Centrality",
term == "b_density" ~ "Density",
term == "b_network.delinquency:density" ~ "Delinquency*Density",
T ~ NA_character_)) %>%
mutate(model = "Model 4") %>%
select(term, estimate, lower, upper, model)
m1 <- m1[complete.cases(m1), ]
m2 <- m2[complete.cases(m2), ]
m3 <- m3[complete.cases(m3), ]
m4 <- m4[complete.cases(m4), ]
effects.data <- rbind(m1, m2, m3, m4)
ggcoef(m1, mapping = aes_string(y = "term", x = "estimate"),
vline = T, vline_intercept = 1, vline_linetype = "dotted", vline_size = 1,
errorbar_color = "seagreen",
sort = "ascending")
ggcoef(m1, mapping = aes_string(y = "term", x = "estimate"),
vline = T, vline_intercept = 1, vline_linetype = "dotted", vline_size = 1,
errorbar_color = "seagreen", conf.int = .89,
sort = "ascending")
ggcoef(m1, mapping = aes_string(y = "term", x = "estimate"),
vline = T, vline_intercept = 1, vline_linetype = "dotted", vline_size = 1,
errorbar_color = "seagreen", conf.int = T,
sort = "ascending")
