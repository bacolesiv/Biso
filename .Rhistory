select(OR)
y <- m2 %>%
mutate(OR = exp((imodel2@coef))) %>%
select(OR)
z <- m3 %>%
mutate(OR = exp((imodel3@coef)))%>%
select(OR)
inames <- c("Age", "Sex", "Family Income", "Weapon Carry", "Network Delinquency", "Popularity", "Centrality", "Density", "Interaction Term", "Intercept")
names <- c("Age", "Sex", "Family Income", "Weapon Carry", "Network Delinquency", "Popularity", "Centrality", "Density", "Intercept")
t4 <- round(t4, digits = 3)
x <- round(x, digits = 3)
y <- round(y, digits = 3)
z <- round(z, digits = 3)
rownames(t4) <- names
rownames(m1) <- inames
rownames(m2) <- inames
rownames(m3) <- inames
t5 <- cbind(x, y, z)
table4 <- kable(t4, caption = "Logistic Regression Model", "latex", booktabs = T) %>%
add_header_above(c("Predictors", "Model 1" = 1)) %>%
kable_styling("striped")
table5 <- kable(t5, caption = "Interaction Models", "latex", booktabs = T) %>%
add_header_above(c("Predictors", "Model 2" = 1, "Model 3" = 1, "Model 4" = 1)) %>%
kable_styling("striped")
race.plot <- mydata.c %>%
filter(race != is.na(race)) %>%
ggplot(aes(x = race, fill = race)) +
geom_bar() + guides(fill = F) +
coord_flip() +
labs(title = "Racial Composition of Respondents", y = "Counts") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.position = "none")
race.victim <- mydata.c %>%
ggplot(aes(x = race)) +
geom_bar(aes(fill = as.character(victim)), position = "fill") + guides(fill = F) +
geom_hline(yintercept=(mean(mydata.c$victim)), linetype = "dashed", color = "red3") +
coord_flip() +
labs(title = "Victimization by Race", y = "Proportion of Victims") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.position = "none")
#Native American and Black Latinos are the most victimized racial groups
a <- mydata %>%
filter(race != is.na(race)) %>%
group_by(race) %>%
summarise(victim = mean(victim, na.rm = T))
#victim rate close to mean for non carriers, much higher for carriers ~ 0.58
b <- mydata %>%
group_by(weapon.carry) %>%
summarise(victim = mean(victim, na.rm = T))
#Dependent Variable Breakdown Summary
Proportion <- sapply(mydata.dv, mean, na.rm = T)
cont1 <- length(which(mydata.dv$knife.gun == 1))
cont2 <- length(which(mydata.dv$shot == 1))
cont3 <- length(which(mydata.dv$stabbed == 1))
cont4 <- length(which(mydata.dv$jumped == 1))
conts <- c(cont1, cont2, cont3, cont4)
names <- c("knife.gun", "shot", "stabbed", "jumped")
Counts <- rbind(conts, names)
colnames(Counts) <- names
Counts <- Counts[-2,1:4]
Proportion <- round(Proportion, digits = 3)
t1 <- cbind(Proportion, Counts)
table1 <- kable(t1, "latex", caption = "Dependent Variable Index", booktabs = T) %>%
kable_styling(latex_options = "striped") %>%
footnote(general = "N = 3145")
#Creating the Summary Statistics
mydata.num <- mydata %>%
select(-AID, -race)
Mean <- sapply(mydata.num, mean, na.rm= T)
Stdv <- sapply(mydata.num, sd, na.rm = T)
Min <- sapply(mydata.num, min, na.rm = T)
Median <- sapply(mydata.num, median, na.rm = T)
Max <- sapply(mydata.num, max, na.rm = T)
t2 <- data.frame(
Items = c("Question 1","Question 2","Question 3","Question 4","Question 5","Question 6","Question 7"),
Features = c("During the past twelve months, how often did you smoke cigarettes?", "During the past twelve months, how often did you drink beer, wine, liqour?", "During the past twelve months, how often did you get drunk?", "During the past twelve months, how often did you race on a bike, skateboard, roller blades, or in a boat or car?", "During the past twelve months, how often did you do something dangerous because you were dared to?", "During the past twelve months, how often did you lie to your parents or guardians?", "During the past twelve months, how often did you skip school without an excuse?"))
table2 <- kable(t2, caption = "Friendship Network Delinquency Index" , "latex", booktabs = T) %>%
kable_styling(full_width = F) %>%
column_spec(1, bold = T) %>%
column_spec(2, width = "30em")
t3 <- round(cbind(Mean, Stdv, Min, Median, Max), digits=3)
table3 <- kable(t3, caption = "Descriptive Statistics","latex", booktabs = T) %>%
kable_styling(latex_options = "striped") %>%
footnote(general = "N = 3145")
table4 <- kable(t4, caption = "Logistic Regression Model","latex", booktabs = T) %>%
kable_styling(latex_options = "striped") %>%
footnote(general = "N = 3145")
table5 <- kable(t5, caption = "Interaction Models", "latex", booktabs = T) %>%
kable_styling(latex_options = "striped") %>%
footnote(general = "N = 3145")
table1
table2
table3
table4
table5
grid.arrange(race.plot, race.victim, nrow = 2)
#New data frame with variables held constant - Interaction terms held at quantiles
age <- mean(mydata.c$age)
female <- mean(mydata.c$female)
family.income <- mean(mydata.c$family.income)
weapon.carry <- mean(mydata.c$weapon.carry)
network.delinquency <- seq(0, 5, by = .1)
popularity <- mean(mydata.c$popularity)
centrality <- quantile(mydata.c$centrality, c(.1, .5, .9))
density <- mean(mydata.c$density)
predictions <- as.tibble(expand.grid(age, female, family.income, weapon.carry, network.delinquency, popularity, centrality, density))
colnames(predictions) <- c("age", "female", "family.income", "weapon.carry", "network.delinquency", "popularity", "centrality", "density")
#inv_logit_scaled() logistic() for BRMS models that you should probably try to run.
#Predicted Likelihood of Victimization added to the newdata
samples <- predictions %>%
mutate(victim = logistic(m1[10,] + m1[1,]*age + m1[2,]*female + m1[3,]*family.income + m1[4,]*weapon.carry + m1[5,]*network.delinquency + m1[6,]*popularity + m1[7,]*centrality + m1[8,]*density + m1[9,]*network.delinquency*centrality)) %>%
group_by(network.delinquency, centrality) %>%
slice(1)
#Visualize: Centrality Interactions
samples$centrality <- as.character(samples$centrality)
samples <- samples %>%
mutate(Centrality = case_when(
centrality == "0" ~ "10th Percentile",
centrality == "0.7867627910904" ~ "50th Percentile",
centrality == "1.70167438806094"  ~ "90th Percentile",
T ~ NA_character_))
plot1 <- ggplot(samples, aes(x = network.delinquency , group = Centrality)) +
geom_line(aes(y = victim, color = Centrality), size = 1.5) +
labs(title = "Conditional Effects of Network Structure and Form on Victimization", subtitle = "Interacting Centrality & Network Delinquency", x = "Average Delinquency in Friendship Network", y = "Probability of Victimization") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5))
plot1
#New data frame with variables held constant - Interaction terms held at quantiles
age <- mean(mydata.c$age)
female <- mean(mydata.c$female)
family.income <- mean(mydata.c$family.income)
weapon.carry <- mean(mydata.c$weapon.carry)
network.delinquency <- seq(0, 5, by = .1)
popularity <- mean(mydata.c$popularity)
centrality <- quantile(mydata.c$centrality, c(.1, .5, .9))
density <- mean(mydata.c$density)
predictions <- as.tibble(expand.grid(age, female, family.income, weapon.carry, network.delinquency, popularity, centrality, density))
colnames(predictions) <- c("age", "female", "family.income", "weapon.carry", "network.delinquency", "popularity", "centrality", "density")
#inv_logit_scaled() logistic() for BRMS models that you should probably try to run.
#Predicted Likelihood of Victimization added to the newdata
samples <- predictions %>%
mutate(victim = logistic(m1[10,] + m1[1,]*age + m1[2,]*female + m1[3,]*family.income + m1[4,]*weapon.carry + m1[5,]*network.delinquency + m1[6,]*popularity + m1[7,]*centrality + m1[8,]*density + m1[9,]*network.delinquency*centrality)) %>%
group_by(network.delinquency, centrality) %>%
slice(1)
#Visualize: Centrality Interactions
samples$centrality <- as.character(samples$centrality)
samples <- samples %>%
mutate(Centrality = case_when(
centrality == "0" ~ "10th Percentile",
centrality == "0.7867627910904" ~ "50th Percentile",
centrality == "1.70167438806094"  ~ "90th Percentile",
T ~ NA_character_))
plot1 <- ggplot(samples, aes(x = network.delinquency , group = Centrality)) +
geom_line(aes(y = victim, color = Centrality), size = 1.5) +
labs(title = "Conditional Effects of Network Structure and Form on Victimization", subtitle = "Interacting Centrality & Network Delinquency", x = "Average Delinquency in Friendship Network", y = "Probability of Victimization") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), plot.subtitle = element_text(hjust = 0.5))
plot1
#New data frame with variables held constant - Interaction terms held at quantiles
age <- mean(mydata.c$age)
female <- mean(mydata.c$female)
family.income <- mean(mydata.c$family.income)
weapon.carry <- mean(mydata.c$weapon.carry, na.rm = T)
network.delinquency <- seq(0, 5, by = .1)
centrality <- mean(mydata.c$centrality, na.rm = T)
density <- quantile(mydata.c$density, c(.1, .5, .9))
popularity <- mean(mydata.c$popularity, na.rm = T)
predictions <- as.tibble(expand.grid(age, female, family.income, weapon.carry, network.delinquency, popularity, centrality, density))
colnames(predictions) <- c("age", "female", "family.income", "weapon.carry", "network.delinquency", "popularity", "centrality", "density")
#Predicted Likelihood of Victimization added to the newdata
samples <- predictions%>%
mutate(victim = logistic(m3[10,] + m3[1,]*age + m3[2,]*female + m3[3,]*family.income + m3[4,]*weapon.carry + m3[5,]*network.delinquency + m3[6,]*popularity + m3[7,]*centrality + m3[8,]*density + m3[9,]*network.delinquency*density))%>%
group_by(network.delinquency, density) %>%
slice(1)
#Visualize: Centrality Interactions
samples$density <- as.character(samples$density)
samples <- samples %>%
mutate(Density = case_when(
density == "0.1571428571429" ~ "10th Percentile",
density == "0.2619047619048" ~ "50th Percentile",
density == "0.5"  ~ "90th Percentile",
T ~ NA_character_))
plot3 <- ggplot(samples, aes(x = network.delinquency , group = Density)) +
geom_line(aes(y = victim, color = Density) , size = 1.5) +
labs(title = "The Conditional Effects of Network Structure and Form on Victimization", subtitle = "The Interaction Effects of Density & Network Delinquency", x = "Average Delinquency in Friendship Network", y = "Probability of Victimization") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5),  plot.subtitle = element_text(hjust = 0.5))
plot3
table4 <- kable(t4, caption = "Logistic Regression Model", "latex", booktabs = T) %>%
add_header_above(c("Predictors", "Model 1" = 1)) %>%
kable_styling("striped")
table5 <- kable(t5, caption = "Interaction Models", "latex", booktabs = T) %>%
add_header_above(c("Predictors", "Model 2" = 1, "Model 3" = 1, "Model 4" = 1)) %>%
kable_styling("striped")
table4
install.packages("grid")
library(tidyverse)
library(dplyr)
library(gridExtra)
library(grid)
library(rethinking)
library(kableExtra)
library(ggthemes)
library(knitr)
#Windows
#load("E:/Repository/Biso/Biso/data/wave1.rda")
#load("E:/Repository/Biso/Biso/data/network.wave1.rda")
#load("E:/Repository/Biso/Biso/data/weights.rda")
#Mac
load("~/desktop/Repository/Biso/data/wave1.rda")
load("~/desktop/Repository/Biso/data/network.wave1.rda")
load("~/desktop/Repository/Biso/data/weights.rda")
#Renamed
wave1.data <- da21600.0001
network.data <- da21600.0003
weights <- da21600.0004
#Merging Relevant Variables into one Data Frame
data1 <- wave1.data %>%
dplyr :: select(AID, H1FV2, H1FV3, H1FV4, H1FV6, S6A, S6B, S6C, S6D, S6E, S4, S1, S2, PA55, H1FV9)
data2 <-  network.data %>%
dplyr :: select(AID, ESRDEN, BCENT10X, IDGX2, SEG1RCE5, ERNRC5, EHRC5, AXS59A, AXS59B, AXS59C, AXS59D, AXS59E, AXS59F, AXS59G, SRCE51, SRCE52, SRCE53, SRCE54, SRCE55)
data3 <- weights %>%
dplyr :: select(AID, GSWGT1)
mydata <- merge(data1, data2, by = "AID")
#mydata <- merge(my.data, data3, by = "AID")
#Race variable
mydata <- mydata %>%
mutate(race = case_when(
(S4 == "(1) (1) Yes (go to Q.5)" & S6A == "(1) (1) Marked") ~ "white latino",
(S4 == "(1) (1) Yes (go to Q.5)" & S6B == "(1) (1) Marked") ~ "black latino",
(S6A == "(1) (1) Marked" & S6B== "(1) (1) Marked") ~ "mixed race",
(S6A == "(1) (1) Marked" & S6C == "(1) (1) Marked") ~ "mixed race",
(S6A == "(1) (1) Marked" & S6D == "(1) (1) Marked") ~ "mixed race",
(S6A == "(1) (1) Marked" & S6E == "(1) (1) Marked") ~ "mixed race",
(S6B == "(1) (1) Marked" & S6C == "(1) (1) Marked") ~ "mixed race",
(S6B == "(1) (1) Marked" & S6D == "(1) (1) Marked") ~ "mixed race",
(S6B == "(1) (1) Marked" & S6E == "(1) (1) Marked") ~ "mixed race",
(S6C == "(1) (1) Marked" & S6D == "(1) (1) Marked") ~ "mixed race",
(S6C == "(1) (1) Marked" & S6E == "(1) (1) Marked") ~ "mixed race",
(S6D == "(1) (1) Marked" & S6E == "(1) (1) Marked") ~ "mixed race",
S4 == "(1) (1) Yes (go to Q.5)" ~ "latino",
S6A == "(1) (1) Marked" ~ "white",
S6B == "(1) (1) Marked" ~ "black",
S6C == "(1) (1) Marked" ~ "asian",
S6D == "(1) (1) Marked" ~ "native american",
S6E == "(1) (1) Marked" ~ "other",
T ~ NA_character_))
#Victimization
mydata <- mydata %>%
mutate(victim = case_when(
(H1FV2 == "(1) (1) Once" |  H1FV2 == "(2) (2) More than once") ~ 1,
(H1FV3 == "(1) (1) Once" |  H1FV3 == "(2) (2) More than once") ~ 1,
(H1FV4 == "(1) (1) Once" |  H1FV4 == "(2) (2) More than once") ~ 1,
(H1FV6 == "(1) (1) Once" |  H1FV6 == "(2) (2) More than once") ~ 1,
H1FV2 == "(0) (0) Never" ~ 0,
H1FV3 == "(0) (0) Never" ~ 0,
H1FV4 == "(0) (0) Never" ~ 0,
H1FV6 == "(0) (0) Never" ~ 0,
T ~ NA_real_))
#Dependent Variable Breakdown Table
mydata <- mydata %>%
mutate(knife.gun = case_when(
(H1FV2 == "(1) (1) Once" |  H1FV2 == "(2) (2) More than once") ~ 1,
H1FV2 == "(0) (0) Never" ~ 0,
T ~ NA_real_))
mydata <- mydata %>%
mutate(shot = case_when(
(H1FV3 == "(1) (1) Once" |  H1FV3 == "(2) (2) More than once") ~ 1,
H1FV3 == "(0) (0) Never" ~ 0,
T ~ NA_real_))
mydata <- mydata %>%
mutate(stabbed = case_when(
(H1FV4 == "(1) (1) Once" |  H1FV4 == "(2) (2) More than once") ~ 1,
H1FV4 == "(0) (0) Never" ~ 0,
T ~ NA_real_))
mydata <- mydata %>%
mutate(jumped = case_when(
(H1FV6 == "(1) (1) Once" |  H1FV6 == "(2) (2) More than once") ~ 1,
H1FV6 == "(0) (0) Never" ~ 0,
T ~ NA_real_))
#Creating the Network Delinquency Variable
mydata <- mydata %>%
mutate(network.delinquency = (AXS59A + AXS59B + AXS59C + AXS59D + AXS59E + AXS59F + AXS59G)/7)
#Cleaning Control Variables
mydata <- mydata %>%
mutate(female = case_when(
S2 == "(1) (1) Male" ~ 0,
S2 == "(2) (2) Female" ~ 1,
T ~ NA_real_))
mydata$age <- mydata$S1
mydata$family.income <- mydata$PA55
mydata <- mydata %>%
mutate(weapon.carry = case_when(
H1FV9 == "(0) (0) None (skip to Q.11)" ~ 0,
(H1FV9 == "(1) (1) 1 day" | H1FV9 == "(2) (2) 2 or 3 days" | H1FV9 == "(3) (3) 4 or 5 days" | H1FV9 == "(4) (4) 6 or more days") ~ 1,
T ~ NA_real_))
#Renaming Network Variables
mydata$racial.heterogeneity <- mydata$ERNRC5
mydata$dense <- mydata$ESRDEN
mydata$centrality <- mydata$BCENT10X
mydata$popularity <- mydata$IDGX2
mydata <- mydata %>%
mutate(den = case_when(
(popularity == 0 & centrality == 0) ~ 0,
T ~ dense))
mydata <- mydata %>%
mutate(density = den*100)
#Variable Selection
mydata.dv <- mydata %>%
select(knife.gun, shot, stabbed, jumped)
mydata <- mydata %>%
select(AID, victim, race, female, age, family.income, weapon.carry, network.delinquency, popularity, centrality, density)
#Only complete rows Kept
mydata.c <- mydata[complete.cases(mydata), ]
View(mydata.c)
model <- map(alist(
victim ~ dbinom(1, p),
logit(p) <- a + b1*age + b2*female + b3*family.income + b4*weapon.carry + b5*network.delinquency + b6*popularity + b7*centrality + b8*density,
a ~ dnorm(0,10),
b1 ~ dnorm(0,10),
b2 ~ dnorm(0,10),
b3 ~ dnorm(0,10),
b4 ~ dnorm(0,10),
b5 ~ dnorm(0,10),
b6 ~ dnorm(0,10),
b7 ~ dnorm(0,10),
b8 ~ dnorm(0,10)), data=mydata.c, start=list(b1=0, b2=0, b3=0, b4=0, b5=0, b6=0, b7=0, b8=0))
imodel1 <- map(alist(
victim ~ dbinom(1, p),
logit(p) <- a + b1*age + b2*female + b3*family.income + b4*weapon.carry + b5*network.delinquency + b6*popularity + b7*centrality + b8*density + b9*network.delinquency*centrality,
a ~ dnorm(0,10),
b1 ~ dnorm(0,10),
b2 ~ dnorm(0,10),
b3 ~ dnorm(0,10),
b4 ~ dnorm(0,10),
b5 ~ dnorm(0,10),
b6 ~ dnorm(0,10),
b7 ~ dnorm(0,10),
b8 ~ dnorm(0,10),
b9 ~ dnorm(0,10)), data=mydata.c, start=list(b1=0, b2=0, b3=0, b4=0, b5=0, b6=0, b7=0, b8=0, b9=0))
imodel2 <- map(alist(
victim ~ dbinom(1, p),
logit(p) <- a + b1*age + b2*female + b3*family.income + b4*weapon.carry + b5*network.delinquency + b6*popularity + b7*centrality + b8*density + b9*network.delinquency*popularity,
a ~ dnorm(0,10),
b1 ~ dnorm(0,10),
b2 ~ dnorm(0,10),
b3 ~ dnorm(0,10),
b4 ~ dnorm(0,10),
b5 ~ dnorm(0,10),
b6 ~ dnorm(0,10),
b7 ~ dnorm(0,10),
b8 ~ dnorm(0,10),
b9 ~ dnorm(0,10)), data=mydata.c, start=list(b1=0, b2=0, b3=0, b4=0, b5=0, b6=0, b7=0, b8=0, b9=0))
imodel3 <- map(alist(
victim ~ dbinom(1, p),
logit(p) <- a + b1*age + b2*female + b3*family.income + b4*weapon.carry + b5*network.delinquency + b6*popularity + b7*centrality + b8*density + b9*network.delinquency*density,
a ~ dnorm(0,10),
b1 ~ dnorm(0,10),
b2 ~ dnorm(0,10),
b3 ~ dnorm(0,10),
b4 ~ dnorm(0,10),
b5 ~ dnorm(0,10),
b6 ~ dnorm(0,10),
b7 ~ dnorm(0,10),
b8 ~ dnorm(0,10),
b9 ~ dnorm(0,10)), data=mydata.c, start=list(b1=0, b2=0, b3=0, b4=0, b5=0, b6=0, b7=0, b8=0, b9=0))
m <- as.data.frame((model@coef),1)
m1 <- as.data.frame((imodel1@coef),1)
m2 <- as.data.frame((imodel2@coef),1)
m3 <- as.data.frame((imodel3@coef),1)
t4 <- m %>%
mutate(OR = exp((model@coef))) %>%
select(OR)
x <- m1 %>%
mutate(OR = exp((imodel1@coef))) %>%
select(OR)
y <- m2 %>%
mutate(OR = exp((imodel2@coef))) %>%
select(OR)
z <- m3 %>%
mutate(OR = exp((imodel3@coef)))%>%
select(OR)
t4 <- round(t4, digits = 3)
x <- round(x, digits = 3)
y <- round(y, digits = 3)
z <- round(z, digits = 3)
inames <- c("Age", "Sex", "Family Income", "Weapon Carry", "Network Delinquency", "Popularity", "Centrality", "Density", "Interaction Term", "Intercept")
names <- c("Age", "Sex", "Family Income", "Weapon Carry", "Network Delinquency", "Popularity", "Centrality", "Density", "Intercept")
rownames(t4) <- names
rownames(x) <- inames
rownames(y) <- inames
rownames(z) <- inames
t5 <- cbind(x, y, z)
table4 <- kable(t4, caption = "Logistic Regression Model", "latex", booktabs = T) %>%
add_header_above(c("Predictors", "Model 1" = 1)) %>%
kable_styling("striped") %>%
footnote(general = "N = 3145")
table5 <- kable(t5, caption = "Interaction Models", "latex", booktabs = T) %>%
add_header_above(c("Predictors", "Model 2" = 1, "Model 3" = 1, "Model 4" = 1)) %>%
kable_styling("striped") %>%
footnote(general = "N = 3145")
m3
View(m3)
#New data frame with variables held constant - Interaction terms held at quantiles
age <- mean(mydata.c$age)
female <- mean(mydata.c$female)
family.income <- mean(mydata.c$family.income)
weapon.carry <- mean(mydata.c$weapon.carry, na.rm = T)
network.delinquency <- seq(0, 5, by = .1)
centrality <- mean(mydata.c$centrality, na.rm = T)
density <- quantile(mydata.c$density, c(.1, .5, .9))
popularity <- mean(mydata.c$popularity, na.rm = T)
predictions <- as.tibble(expand.grid(age, female, family.income, weapon.carry, network.delinquency, popularity, centrality, density))
colnames(predictions) <- c("age", "female", "family.income", "weapon.carry", "network.delinquency", "popularity", "centrality", "density")
#Predicted Likelihood of Victimization added to the newdata
samples <- predictions%>%
mutate(victim = logistic(m3[10,] + m3[1,]*age + m3[2,]*female + m3[3,]*family.income + m3[4,]*weapon.carry + m3[5,]*network.delinquency + m3[6,]*popularity + m3[7,]*centrality + m3[8,]*density + m3[9,]*network.delinquency*density))%>%
group_by(network.delinquency, density) %>%
slice(1)
#Visualize: Centrality Interactions
samples$density <- as.character(samples$density)
samples <- samples %>%
mutate(Density = case_when(
density == "0.1571428571429" ~ "10th Percentile",
density == "0.2619047619048" ~ "50th Percentile",
density == "0.5"  ~ "90th Percentile",
T ~ NA_character_))
plot3 <- ggplot(samples, aes(x = network.delinquency , group = Density)) +
geom_line(aes(y = victim, color = Density) , size = 1.5) +
labs(title = "The Conditional Effects of Network Structure and Form on Victimization", subtitle = "The Interaction Effect of Density & Network Delinquency", x = "Average Delinquency in Friendship Network", y = "Probability of Victimization", caption = "Figure 4") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5),  plot.subtitle = element_text(hjust = 0.5))
View(samples)
#Windows
#data1 <- readRDS("E:/Repository/Chicago/Data/cook-block-group-acs5-2011.rds")
#data2 <- readRDS("E:/Repository/Chicago/Data/cook-block-group-sf1-2000.rds")
#data3 <- readRDS("E:/Repository/Chicago/Data/cook-block-group-sf1-2010.rds")
#data4 <- readRDS("E:/Repository/Chicago/Data/cook-block-group-sf3-2000.rds")
#data5 <- readRDS("E:/Repository/Chicago/Data/cook-census-block-sf1-2000.rds")
#data6 <- readRDS("E:/Repository/Chicago/Data/cook-census-block-sf1-2010.rds")
#Mac
data1 <- readRDS("~/desktop/Repository/Chicago/Data/cook-block-group-acs5-2011.rds")
data2 <- readRDS("~/desktop/Repository/Chicago/Data/cook-block-group-sf1-2000.rds")
data3 <- readRDS("~/desktop/Repository/Chicago/Data/cook-block-group-sf1-2010.rds")
data4 <- readRDS("~/desktop/Repository/Chicago/Data/cook-block-group-sf3-2000.rds")
data5 <- readRDS("~/desktop/Repository/Chicago/Data/cook-census-block-sf1-2000.rds")
data6 <- readRDS("~/desktop/Repository/Chicago/Data/cook-census-block-sf1-2010.rds")
#codebook code is on mac or ipad
View(data1)
View(data2)
View(data2)
?readRDS
p_to_logodds <- function(p){log(p/(1-p))}
p_to_logodds(0.35)
logodds_to_p <- function(logodds){exp(logodds)/(1+exp(logodds))}
logodds_to_p(-0.62)
p <- 0.35
q <- 1 - 0.35
log(p) - log(q)
library(tidyverse)
library(rethinking)
logistic(0.35)
logistic(0.35)
p <- 0.35
q <- 1 - 0.35
log(p) - log(q)
p <- 3.2
q <- 1 + exp(3.2)
log(p) - log(q)
exp(3.2)
logistic(3.2)
a <- logistic(3.2)
exp(a)
p <- logistic(3.2)
q <- 1 - p
log(p) - log(q)
p <- 0.35
q <- 1 - 0.35
log(p) - log(q)
logistic(3.2)
exp(1.7)
p <- 0.35
q <- 1 - 0.35
log(p) - log(q)
logistic(3.2)
p <- 0.35
q <- 1 - 0.35
a <- log(p) - log(q)
logistic(a)
p <- logistic(3.2)
p
#Check
q <- 1-p
log(p) - log(q)
p <- 0.35
q <- 1 - 0.35
a <- log(p) - log(q)
a
#Check
logistic(a)
