a
a <- fixef(imodel1) %>%
round(digits = 3) %>%
tidy() %>%
mutate(OR = exp(Estimate),
`2.5%` = exp(Q2.5),
`97.5%` = exp(Q97.5)) %>%
select(OR, `2.5%`, `97.5%`)
anames <- fixef(imodel1) %>%
round(digits = 3) %>%
tidy() %>%
select(.rownames)
rownames(a) <- anames
anames
anames
rownames(a) <- anames
t4
a <- fixef(imodel1) %>%
round(digits = 3) %>%
tidy() %>%
mutate(OR = exp(Estimate),
`2.5%` = exp(Q2.5),
`97.5%` = exp(Q97.5)) %>%
select(OR, `2.5%`, `97.5%`)
a
a <- fixef(imodel1) %>%
round(digits = 3) %>%
tidy() %>%
mutate(OR = exp(Estimate),
`2.5%` = exp(Q2.5),
`97.5%` = exp(Q97.5)) %>%
select(OR, `2.5%`, `97.5%`)
b <- fixef(imodel2) %>%
round(digits = 3) %>%
tidy() %>%
mutate(OR = exp(Estimate),
`2.5%` = exp(Q2.5),
`97.5%` = exp(Q97.5)) %>%
select(OR, `2.5%`, `97.5%`)
c <- fixef(imodel3) %>%
round(digits = 3) %>%
tidy() %>%
mutate(OR = exp(Estimate),
`2.5%` = exp(Q2.5),
`97.5%` = exp(Q97.5)) %>%
select(OR, `2.5%`, `97.5%`)
t5 <- cbind(a,b,c)
t5
t4 <- fixef(model) %>%
round(digits = 3) %>%
tidy() %>%
mutate(OR = exp(Estimate),
`2.5%` = exp(Q2.5),
`97.5%` = exp(Q97.5),
Variables = .rownames) %>%
select(Variables, OR, `2.5%`, `97.5%`)
a <- fixef(imodel1) %>%
tidy() %>%
mutate(OR = exp(Estimate),
`2.5%` = exp(Q2.5),
`97.5%` = exp(Q97.5)) %>%
select(OR, `2.5%`, `97.5%`)
b <- fixef(imodel2) %>%
tidy() %>%
mutate(OR = exp(Estimate),
`2.5%` = exp(Q2.5),
`97.5%` = exp(Q97.5)) %>%
select(OR, `2.5%`, `97.5%`)
c <- fixef(imodel3) %>%
tidy() %>%
mutate(OR = exp(Estimate),
`2.5%` = exp(Q2.5),
`97.5%` = exp(Q97.5)) %>%
select(OR, `2.5%`, `97.5%`)
t5 <- cbind(a,b,c) %>%
round(digits = 3)
names <- c("Intercept", "Age", "Sex", "Family Income", "Weapon Carry", "Racial Heterogeneity",  "Network Delinquency", "Popularity", "Centrality", "Density", "Interaction Term")
rownames(t5) <- names
t5
model <- add_criterion(model, "waic")
ic <- loo_compare(model, imodel1, imodel2, imodel3, criterion = "waic")
install.packages("loo")
install.packages("loo")
install.packages("loo")
install.packages("loo")
library(loo)
model <- add_criterion(model, "waic")
library(tidyverse)
library(dplyr)
library(gridExtra)
library(grid)
library(rethinking)
library(kableExtra)
library(ggthemes)
library(knitr)
library(broom)
library(brms)
library(loo)
#Windows
#load("E:/Repository/Biso/Biso/data/wave1.rda")
#load("E:/Repository/Biso/Biso/data/network.wave1.rda")
#load("E:/Repository/Biso/Biso/data/weights.rda")
#Mac
load("~/desktop/Repository/Biso/data/wave1.rda")
load("~/desktop/Repository/Biso/data/network.wave1.rda")
load("~/desktop/Repository/Biso/data/weights.rda")
#Renamed
wave1.data <- da21600.0001
network.data <- da21600.0003
weights <- da21600.0004
#Merging Relevant Variables into one Data Frame
data1 <- wave1.data %>%
dplyr :: select(AID, H1FV2, H1FV3, H1FV4, H1FV6, S6A, S6B, S6C, S6D, S6E, S4, S1, S2, PA55, H1FV9)
data2 <-  network.data %>%
dplyr :: select(AID, ESRDEN, BCENT10X, IDGX2, SEG1RCE5, ERNRC5, EHRC5, AXS59A, AXS59B, AXS59C, AXS59D, AXS59E, AXS59F, AXS59G, SRCE51, SRCE52, SRCE53, SRCE54, SRCE55)
data3 <- weights %>%
dplyr :: select(AID, GSWGT1)
mydata <- merge(data1, data2, by = "AID")
#mydata <- merge(my.data, data3, by = "AID")
#Race variable
mydata <- mydata %>%
mutate(race = case_when(
(S4 == "(1) (1) Yes (go to Q.5)" & S6A == "(1) (1) Marked") ~ "white latino",
(S4 == "(1) (1) Yes (go to Q.5)" & S6B == "(1) (1) Marked") ~ "black latino",
(S6A == "(1) (1) Marked" & S6B== "(1) (1) Marked") ~ "mixed race",
(S6A == "(1) (1) Marked" & S6C == "(1) (1) Marked") ~ "mixed race",
(S6A == "(1) (1) Marked" & S6D == "(1) (1) Marked") ~ "mixed race",
(S6A == "(1) (1) Marked" & S6E == "(1) (1) Marked") ~ "mixed race",
(S6B == "(1) (1) Marked" & S6C == "(1) (1) Marked") ~ "mixed race",
(S6B == "(1) (1) Marked" & S6D == "(1) (1) Marked") ~ "mixed race",
(S6B == "(1) (1) Marked" & S6E == "(1) (1) Marked") ~ "mixed race",
(S6C == "(1) (1) Marked" & S6D == "(1) (1) Marked") ~ "mixed race",
(S6C == "(1) (1) Marked" & S6E == "(1) (1) Marked") ~ "mixed race",
(S6D == "(1) (1) Marked" & S6E == "(1) (1) Marked") ~ "mixed race",
S4 == "(1) (1) Yes (go to Q.5)" ~ "latino",
S6A == "(1) (1) Marked" ~ "white",
S6B == "(1) (1) Marked" ~ "black",
S6C == "(1) (1) Marked" ~ "asian",
S6D == "(1) (1) Marked" ~ "native american",
S6E == "(1) (1) Marked" ~ "other",
T ~ NA_character_))
#Victimization
mydata <- mydata %>%
mutate(victim = case_when(
(H1FV2 == "(1) (1) Once" |  H1FV2 == "(2) (2) More than once") ~ 1,
(H1FV3 == "(1) (1) Once" |  H1FV3 == "(2) (2) More than once") ~ 1,
(H1FV4 == "(1) (1) Once" |  H1FV4 == "(2) (2) More than once") ~ 1,
(H1FV6 == "(1) (1) Once" |  H1FV6 == "(2) (2) More than once") ~ 1,
H1FV2 == "(0) (0) Never" ~ 0,
H1FV3 == "(0) (0) Never" ~ 0,
H1FV4 == "(0) (0) Never" ~ 0,
H1FV6 == "(0) (0) Never" ~ 0,
T ~ NA_real_))
#Dependent Variable Breakdown Table
mydata <- mydata %>%
mutate(knife.gun = case_when(
(H1FV2 == "(1) (1) Once" |  H1FV2 == "(2) (2) More than once") ~ 1,
H1FV2 == "(0) (0) Never" ~ 0,
T ~ NA_real_))
mydata <- mydata %>%
mutate(shot = case_when(
(H1FV3 == "(1) (1) Once" |  H1FV3 == "(2) (2) More than once") ~ 1,
H1FV3 == "(0) (0) Never" ~ 0,
T ~ NA_real_))
mydata <- mydata %>%
mutate(stabbed = case_when(
(H1FV4 == "(1) (1) Once" |  H1FV4 == "(2) (2) More than once") ~ 1,
H1FV4 == "(0) (0) Never" ~ 0,
T ~ NA_real_))
mydata <- mydata %>%
mutate(jumped = case_when(
(H1FV6 == "(1) (1) Once" |  H1FV6 == "(2) (2) More than once") ~ 1,
H1FV6 == "(0) (0) Never" ~ 0,
T ~ NA_real_))
#Creating the Network Delinquency Variable
mydata <- mydata %>%
mutate(network.delinquency = (AXS59A + AXS59B + AXS59C + AXS59D + AXS59E + AXS59F + AXS59G)/7)
#Cleaning Control Variables
mydata <- mydata %>%
mutate(female = case_when(
S2 == "(1) (1) Male" ~ 0,
S2 == "(2) (2) Female" ~ 1,
T ~ NA_real_))
mydata$age <- mydata$S1
mydata$family.income <- mydata$PA55
mydata <- mydata %>%
mutate(weapon.carry = case_when(
H1FV9 == "(0) (0) None (skip to Q.11)" ~ 0,
(H1FV9 == "(1) (1) 1 day" | H1FV9 == "(2) (2) 2 or 3 days" | H1FV9 == "(3) (3) 4 or 5 days" | H1FV9 == "(4) (4) 6 or more days") ~ 1,
T ~ NA_real_))
#Renaming Network Variables
mydata$racial.heterogeneity <- mydata$ERNRC5
mydata$dense <- mydata$ESRDEN
mydata$centrality <- mydata$BCENT10X
mydata$popularity <- mydata$IDGX2
mydata <- mydata %>%
mutate(den = case_when(
(popularity == 0 & centrality == 0) ~ 0,
T ~ dense))
mydata <- mydata %>%
mutate(density = den*100)
#Variable Selection
mydata.dv <- mydata %>%
select(knife.gun, shot, stabbed, jumped)
mydata <- mydata %>%
select(AID, victim, race, female, age, family.income, weapon.carry, racial.heterogeneity, network.delinquency, popularity, centrality, density)
#Only complete rows Kept
mydata.c <- mydata[complete.cases(mydata), ]
model <- brm(data = mydata.c, family = binomial,
victim | trials(1) ~ 1 + age + female + family.income + weapon.carry + racial.heterogeneity + network.delinquency + popularity + centrality + density,
prior = c(prior(normal(0, 10), class = Intercept),
prior(normal(0, 10), class = b)),
iter = 2500, warmup = 500, cores = 4, chains = 4, seed = 10)
imodel1 <- update(model, newdata = mydata.c, formula = victim | trials(1) ~ 1 + age + female + family.income + weapon.carry + racial.heterogeneity + network.delinquency + popularity + centrality + density + network.delinquency:centrality)
imodel2 <- update(model, newdata = mydata.c, formula = victim | trials(1) ~ 1 + age + female + family.income + weapon.carry + racial.heterogeneity + network.delinquency + popularity + centrality + density + network.delinquency:popularity)
imodel3 <- update(model, newdata = mydata.c, formula = victim | trials(1) ~ 1 + age + female + family.income + weapon.carry + racial.heterogeneity + network.delinquency + popularity + centrality + density + network.delinquency:density)
#Evaluating Information Criteria
waic(model)
#Evaluating Information Criteria
waic(model)
waic
model_weights(model, imodel1, imodel2, imodel3, weights = "waic") %>%
round(digits = 3)
model_weights(model, imodel1, imodel2, imodel3, weights = "waic") %>%
round(digits = 2)
ic <- model_weights(model, imodel1, imodel2, imodel3, weights = "waic") %>%
round(digits = 2) %>%
tidy()
ic
ic <- model_weights(model, imodel1, imodel2, imodel3, weights = "waic") %>%
round(digits = 2) %>%
tidy() %>%
desc()
ic <- model_weights(model, imodel1, imodel2, imodel3, weights = "waic") %>%
round(digits = 2) %>%
tidy() %>%
desc(x)
ic <- model_weights(model, imodel1, imodel2, imodel3, weights = "waic") %>%
round(digits = 2) %>%
tidy() %>%
arrange(desc(x))
ic
ic <- model_weights(model, imodel1, imodel2, imodel3, weights = "waic") %>%
round(digits = 2) %>%
tidy() %>%
mutate(Weight = x,
Model = names)
arrange(desc(Weight)) %>%
select(Model, Weight)
ic <- model_weights(model, imodel1, imodel2, imodel3, weights = "waic") %>%
round(digits = 2) %>%
tidy() %>%
mutate(Weight = x,
Model = names)
ic <- model_weights(model, imodel1, imodel2, imodel3, weights = "waic") %>%
round(digits = 2) %>%
tidy() %>%
mutate(Weight = x,
Model = names) %>%
arrange(desc(Weight)) %>%
select(Model, Weight)
ic
ic <- model_weights(model, imodel1, imodel2, imodel3, weights = "waic") %>%
round(digits = 2) %>%
tidy() %>%
mutate(Weight = x,
Model = names) %>%
arrange(desc(Weight)) %>%
select(Model, Weight) %>%
kable()
ic
#New data frame with variables held constant - Interaction terms held at quantiles
age <- mean(mydata.c$age)
female <- mean(mydata.c$female)
family.income <- mean(mydata.c$family.income)
weapon.carry <- mean(mydata.c$weapon.carry, na.rm = T)
racial.heterogeneity <- mean(mydata.c$racial.heterogeneity)
network.delinquency <- seq(0, 5, by = .1)
centrality <- mean(mydata.c$centrality, na.rm = T)
density <- quantile(mydata.c$density, c(.1, .5, .9))
popularity <- mean(mydata.c$popularity, na.rm = T)
predictions <- as.tibble(expand.grid(age, female, family.income, weapon.carry, racial.heterogeneity, network.delinquency, popularity, centrality, density))
colnames(predictions) <- c("age", "female", "family.income", "weapon.carry","racial.heterogeneity", "network.delinquency", "popularity", "centrality", "density")
e <- fixef(imodel3)
#Predicted Likelihood of Victimization added to the newdata
samples <- predictions %>%
mutate(victim = inv_logit_scaled(e[1,1] + e[2,1]*age + e[3,1]*female + e[4,1]*family.income + e[5,1]*weapon.carry + e[6,1]*racial.heterogeneity + e[7,1]*network.delinquency + e[8,1]*popularity + e[9,1]*centrality + e[10,1]*density + e[11,1]*network.delinquency*density)) %>%
group_by(network.delinquency, density) %>%
slice(1)
#Visualize: Centrality Interactions
samples$density <- as.character(samples$density)
samples <- samples %>%
mutate(Density = case_when(
density == "15.71428571429" ~ "10th Percentile",
density == "26.19047619048" ~ "50th Percentile",
density == "50"  ~ "90th Percentile",
T ~ NA_character_))
plot3 <- ggplot(samples, aes(x = network.delinquency , group = Density)) +
geom_line(aes(y = victim, color = Density) , size = 1.5) +
labs(title = "The Conditional Effects of Network Content and Form on Victimization", subtitle = "The Interaction Effect of Density & Network Delinquency", x = "Average Delinquency in Friendship Network", y = "Probability of Victimization", caption = "Figure 4") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5, size = 10),  plot.subtitle = element_text(hjust = 0.5)) +
ggsave("plot3.pdf", width = 20, height = 15, units = "cm")
plot3
plot3 <- ggplot(samples, aes(x = network.delinquency , group = Density)) +
geom_line(aes(y = victim, color = Density) , size = 1.5) +
labs(title = "The Conditional Effects of Network Content and Form on Victimization", subtitle = "The Interaction Effect of Density & Network Delinquency", x = "Average Delinquency in Friendship Network", y = "Probability of Victimization", caption = "Figure 4") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5, size = 13),  plot.subtitle = element_text(hjust = 0.5)) +
ggsave("plot3.pdf", width = 20, height = 15, units = "cm")
plot3
set.seed(10)
#Evaluating Information Criteria
table4 <- model_weights(model, imodel1, imodel2, imodel3, weights = "waic") %>%
as_tibble() %>%
rename(weight = value) %>%
mutate(model  = c("Model 1", "Model 2", "Model 3", "Model 4"),
weight = weight %>% round(digits = 2)) %>%
select(model, weight) %>%
arrange(desc(weight)) %>%
kable(caption = "Comparing Model Weights", "latex", booktabs = T) %>%
kable_styling("striped")
table4
set.seed(10)
#Evaluating Information Criteria
table4 <- model_weights(model, imodel1, imodel2, imodel3, weights = "waic") %>%
as_tibble() %>%
rename(weight = value) %>%
mutate(model  = c("Model 1", "Model 2", "Model 3", "Model 4"),
weight = weight %>% round(digits = 2)) %>%
select(model, weight) %>%
arrange(desc(weight)) %>%
kable(caption = "Comparing Model Weights", "latex", booktabs = T) %>%
kable_styling("striped")
table4
library(tidyverse)
library(dplyr)
library(gridExtra)
library(grid)
library(rethinking)
library(kableExtra)
library(ggthemes)
library(knitr)
library(broom)
library(brms)
library(loo)
#Windows
#load("E:/Repository/Biso/Biso/data/wave1.rda")
#load("E:/Repository/Biso/Biso/data/network.wave1.rda")
#load("E:/Repository/Biso/Biso/data/weights.rda")
#Mac
load("~/desktop/Repository/Biso/data/wave1.rda")
load("~/desktop/Repository/Biso/data/network.wave1.rda")
load("~/desktop/Repository/Biso/data/weights.rda")
#Renamed
wave1.data <- da21600.0001
network.data <- da21600.0003
weights <- da21600.0004
#Merging Relevant Variables into one Data Frame
data1 <- wave1.data %>%
dplyr :: select(AID, H1FV2, H1FV3, H1FV4, H1FV6, S6A, S6B, S6C, S6D, S6E, S4, S1, S2, PA55, H1FV9)
data2 <-  network.data %>%
dplyr :: select(AID, ESRDEN, BCENT10X, IDGX2, SEG1RCE5, ERNRC5, EHRC5, AXS59A, AXS59B, AXS59C, AXS59D, AXS59E, AXS59F, AXS59G, SRCE51, SRCE52, SRCE53, SRCE54, SRCE55)
data3 <- weights %>%
dplyr :: select(AID, GSWGT1)
mydata <- merge(data1, data2, by = "AID")
#mydata <- merge(my.data, data3, by = "AID")
#Race variable
mydata <- mydata %>%
mutate(race = case_when(
(S4 == "(1) (1) Yes (go to Q.5)" & S6A == "(1) (1) Marked") ~ "white latino",
(S4 == "(1) (1) Yes (go to Q.5)" & S6B == "(1) (1) Marked") ~ "black latino",
(S6A == "(1) (1) Marked" & S6B== "(1) (1) Marked") ~ "mixed race",
(S6A == "(1) (1) Marked" & S6C == "(1) (1) Marked") ~ "mixed race",
(S6A == "(1) (1) Marked" & S6D == "(1) (1) Marked") ~ "mixed race",
(S6A == "(1) (1) Marked" & S6E == "(1) (1) Marked") ~ "mixed race",
(S6B == "(1) (1) Marked" & S6C == "(1) (1) Marked") ~ "mixed race",
(S6B == "(1) (1) Marked" & S6D == "(1) (1) Marked") ~ "mixed race",
(S6B == "(1) (1) Marked" & S6E == "(1) (1) Marked") ~ "mixed race",
(S6C == "(1) (1) Marked" & S6D == "(1) (1) Marked") ~ "mixed race",
(S6C == "(1) (1) Marked" & S6E == "(1) (1) Marked") ~ "mixed race",
(S6D == "(1) (1) Marked" & S6E == "(1) (1) Marked") ~ "mixed race",
S4 == "(1) (1) Yes (go to Q.5)" ~ "latino",
S6A == "(1) (1) Marked" ~ "white",
S6B == "(1) (1) Marked" ~ "black",
S6C == "(1) (1) Marked" ~ "asian",
S6D == "(1) (1) Marked" ~ "native american",
S6E == "(1) (1) Marked" ~ "other",
T ~ NA_character_))
#Victimization
mydata <- mydata %>%
mutate(victim = case_when(
(H1FV2 == "(1) (1) Once" |  H1FV2 == "(2) (2) More than once") ~ 1,
(H1FV3 == "(1) (1) Once" |  H1FV3 == "(2) (2) More than once") ~ 1,
(H1FV4 == "(1) (1) Once" |  H1FV4 == "(2) (2) More than once") ~ 1,
(H1FV6 == "(1) (1) Once" |  H1FV6 == "(2) (2) More than once") ~ 1,
H1FV2 == "(0) (0) Never" ~ 0,
H1FV3 == "(0) (0) Never" ~ 0,
H1FV4 == "(0) (0) Never" ~ 0,
H1FV6 == "(0) (0) Never" ~ 0,
T ~ NA_real_))
#Dependent Variable Breakdown Table
mydata <- mydata %>%
mutate(knife.gun = case_when(
(H1FV2 == "(1) (1) Once" |  H1FV2 == "(2) (2) More than once") ~ 1,
H1FV2 == "(0) (0) Never" ~ 0,
T ~ NA_real_))
mydata <- mydata %>%
mutate(shot = case_when(
(H1FV3 == "(1) (1) Once" |  H1FV3 == "(2) (2) More than once") ~ 1,
H1FV3 == "(0) (0) Never" ~ 0,
T ~ NA_real_))
mydata <- mydata %>%
mutate(stabbed = case_when(
(H1FV4 == "(1) (1) Once" |  H1FV4 == "(2) (2) More than once") ~ 1,
H1FV4 == "(0) (0) Never" ~ 0,
T ~ NA_real_))
mydata <- mydata %>%
mutate(jumped = case_when(
(H1FV6 == "(1) (1) Once" |  H1FV6 == "(2) (2) More than once") ~ 1,
H1FV6 == "(0) (0) Never" ~ 0,
T ~ NA_real_))
#Creating the Network Delinquency Variable
mydata <- mydata %>%
mutate(network.delinquency = (AXS59A + AXS59B + AXS59C + AXS59D + AXS59E + AXS59F + AXS59G)/7)
#Cleaning Control Variables
mydata <- mydata %>%
mutate(female = case_when(
S2 == "(1) (1) Male" ~ 0,
S2 == "(2) (2) Female" ~ 1,
T ~ NA_real_))
mydata$age <- mydata$S1
mydata$family.income <- mydata$PA55
mydata <- mydata %>%
mutate(weapon.carry = case_when(
H1FV9 == "(0) (0) None (skip to Q.11)" ~ 0,
(H1FV9 == "(1) (1) 1 day" | H1FV9 == "(2) (2) 2 or 3 days" | H1FV9 == "(3) (3) 4 or 5 days" | H1FV9 == "(4) (4) 6 or more days") ~ 1,
T ~ NA_real_))
#Renaming Network Variables
mydata$racial.heterogeneity <- mydata$ERNRC5
mydata$dense <- mydata$ESRDEN
mydata$centrality <- mydata$BCENT10X
mydata$popularity <- mydata$IDGX2
mydata <- mydata %>%
mutate(den = case_when(
(popularity == 0 & centrality == 0) ~ 0,
T ~ dense))
mydata <- mydata %>%
mutate(density = den*100)
#Variable Selection
mydata.dv <- mydata %>%
select(knife.gun, shot, stabbed, jumped)
mydata <- mydata %>%
select(AID, victim, race, female, age, family.income, weapon.carry, racial.heterogeneity, network.delinquency, popularity, centrality, density)
#Only complete rows Kept
mydata.c <- mydata[complete.cases(mydata), ]
model <- brm(data = mydata.c, family = binomial,
victim | trials(1) ~ 1 + age + female + family.income + weapon.carry + racial.heterogeneity + network.delinquency + popularity + centrality + density,
prior = c(prior(normal(0, 10), class = Intercept),
prior(normal(0, 10), class = b)),
iter = 2500, warmup = 500, cores = 4, chains = 4, seed = 10)
imodel1 <- update(model, newdata = mydata.c, formula = victim | trials(1) ~ 1 + age + female + family.income + weapon.carry + racial.heterogeneity + network.delinquency + popularity + centrality + density + network.delinquency:centrality)
imodel2 <- update(model, newdata = mydata.c, formula = victim | trials(1) ~ 1 + age + female + family.income + weapon.carry + racial.heterogeneity + network.delinquency + popularity + centrality + density + network.delinquency:popularity)
imodel3 <- update(model, newdata = mydata.c, formula = victim | trials(1) ~ 1 + age + female + family.income + weapon.carry + racial.heterogeneity + network.delinquency + popularity + centrality + density + network.delinquency:density)
set.seed(10)
#Evaluating Information Criteria
table4 <- model_weights(model, imodel1, imodel2, imodel3, weights = "waic") %>%
as_tibble() %>%
rename(weight = value) %>%
mutate(Model  = c("Model 1", "Model 2", "Model 3", "Model 4"),
Weight = weight %>% round(digits = 2)) %>%
select(Model, Weight) %>%
arrange(desc(Weight)) %>%
kable(caption = "Comparing Model Weights", "latex", booktabs = T) %>%
kable_styling("striped")
#Odds Ratios Generated from the Models
t5 <- fixef(model) %>%
tidy() %>%
mutate(OR = exp(Estimate),
`2.5%` = exp(Q2.5),
`97.5%` = exp(Q97.5)) %>%
select(OR, `2.5%`, `97.5%`)
name <- c("Intercept", "Age", "Sex", "Family Income", "Weapon Carry", "Racial Heterogeneity",  "Network Delinquency", "Popularity", "Centrality", "Density")
t5 <- t5 %>%
round(digits = 3)
rownames(t5) <- name
a <- fixef(imodel1) %>%
tidy() %>%
mutate(OR = exp(Estimate),
`2.5%` = exp(Q2.5),
`97.5%` = exp(Q97.5)) %>%
select(OR, `2.5%`, `97.5%`)
b <- fixef(imodel2) %>%
tidy() %>%
mutate(OR = exp(Estimate),
`2.5%` = exp(Q2.5),
`97.5%` = exp(Q97.5)) %>%
select(OR, `2.5%`, `97.5%`)
c <- fixef(imodel3) %>%
tidy() %>%
mutate(OR = exp(Estimate),
`2.5%` = exp(Q2.5),
`97.5%` = exp(Q97.5)) %>%
select(OR, `2.5%`, `97.5%`)
t6 <- cbind(a,b,c) %>%
round(digits = 3)
names <- c("Intercept", "Age", "Sex", "Family Income", "Weapon Carry", "Racial Heterogeneity",  "Network Delinquency", "Popularity", "Centrality", "Density", "Interaction Term")
rownames(t5) <- names
