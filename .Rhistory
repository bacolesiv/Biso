race.rh <- mydata.c %>%
ggplot() +
geom_bar(mapping = aes(x = rh.cat, fill = victim))
race.rh
race.rh <- mydata.c %>%
ggplot() +
geom_bar(mapping = aes(x = rh.cat, fill = victim), position = "fill")
race.rh
race.rh <- mydata.c %>%
ggplot() +
geom_bar(mapping = aes(x = rh.cat, fill = Victim), position = "fill")
race.rh
mydata.c$Victim <- as.factor(mydata.c$victim)
race.rh <- mydata.c %>%
ggplot() +
geom_bar(mapping = aes(x = rh.cat, fill = Victim), position = "fill")
race.rh
grid.arrange(race.plot, race.victim, nrow = 2, bottom = textGrob("Figure 1", x = .9, y = .5, gp = gpar(fontsize = 8)))
a <- grid.arrange(race.plot, race.victim, nrow = 2, bottom = textGrob("Figure 1", x = .9, y = .5, gp = gpar(fontsize = 8)))
ggsave("race_plot.pdf", a, width = 25, height = 15, units = "cm")
library(tidyverse)
library(dplyr)
library(gridExtra)
library(grid)
library(rethinking)
library(kableExtra)
library(ggthemes)
library(knitr)
library(broom)
library(brms)
library(loo)
#Windows
#load("E:/Repository/Biso/Biso/data/wave1.rda")
#load("E:/Repository/Biso/Biso/data/network.wave1.rda")
#load("E:/Repository/Biso/Biso/data/weights.rda")
#Mac
load("~/desktop/Repository/Biso/data/wave1.rda")
load("~/desktop/Repository/Biso/data/network.wave1.rda")
load("~/desktop/Repository/Biso/data/weights.rda")
#Renamed
wave1.data <- da21600.0001
network.data <- da21600.0003
weights <- da21600.0004
#Merging Relevant Variables into one Data Frame
data1 <- wave1.data %>%
dplyr :: select(AID, H1FV2, H1FV3, H1FV4, H1FV6, S6A, S6B, S6C, S6D, S6E, S4, S1, S2, PA55, H1FV9)
data2 <-  network.data %>%
dplyr :: select(AID, ESRDEN, BCENT10X, IDGX2, SEG1RCE5, ERNRC5, EHRC5, AXS59A, AXS59B, AXS59C, AXS59D, AXS59E, AXS59F, AXS59G, SRCE51, SRCE52, SRCE53, SRCE54, SRCE55)
data3 <- weights %>%
dplyr :: select(AID, GSWGT1)
mydata <- merge(data1, data2, by = "AID")
#mydata <- merge(my.data, data3, by = "AID")
#Merging Relevant Variables into one Data Frame
data1 <- wave1.data %>%
dplyr :: select(AID, H1FV2, H1FV3, H1FV4, H1FV6, S6A, S6B, S6C, S6D, S6E, S4, S1, S2, PA55, H1FV9)
data2 <-  network.data %>%
dplyr :: select(AID, ESRDEN, BCENT10X, IDGX2, SEG1RCE5, ERNRC5, EHRC5, AXS59A, AXS59B, AXS59C, AXS59D, AXS59E, AXS59F, AXS59G, SRCE51, SRCE52, SRCE53, SRCE54, SRCE55)
data3 <- weights %>%
dplyr :: select(AID, GSWGT1)
mydata <- merge(data1, data2, by = "AID")
#mydata <- merge(my.data, data3, by = "AID")
#Race variable
mydata <- mydata %>%
mutate(race = case_when(
(S4 == "(1) (1) Yes (go to Q.5)" & S6A == "(1) (1) Marked") ~ "white latino",
(S4 == "(1) (1) Yes (go to Q.5)" & S6B == "(1) (1) Marked") ~ "black latino",
(S6A == "(1) (1) Marked" & S6B== "(1) (1) Marked") ~ "mixed race",
(S6A == "(1) (1) Marked" & S6C == "(1) (1) Marked") ~ "mixed race",
(S6A == "(1) (1) Marked" & S6D == "(1) (1) Marked") ~ "mixed race",
(S6A == "(1) (1) Marked" & S6E == "(1) (1) Marked") ~ "mixed race",
(S6B == "(1) (1) Marked" & S6C == "(1) (1) Marked") ~ "mixed race",
(S6B == "(1) (1) Marked" & S6D == "(1) (1) Marked") ~ "mixed race",
(S6B == "(1) (1) Marked" & S6E == "(1) (1) Marked") ~ "mixed race",
(S6C == "(1) (1) Marked" & S6D == "(1) (1) Marked") ~ "mixed race",
(S6C == "(1) (1) Marked" & S6E == "(1) (1) Marked") ~ "mixed race",
(S6D == "(1) (1) Marked" & S6E == "(1) (1) Marked") ~ "mixed race",
S4 == "(1) (1) Yes (go to Q.5)" ~ "latino",
S6A == "(1) (1) Marked" ~ "white",
S6B == "(1) (1) Marked" ~ "black",
S6C == "(1) (1) Marked" ~ "asian",
S6D == "(1) (1) Marked" ~ "native american",
S6E == "(1) (1) Marked" ~ "other",
T ~ NA_character_))
#Victimization
mydata <- mydata %>%
mutate(victim = case_when(
(H1FV2 == "(1) (1) Once" |  H1FV2 == "(2) (2) More than once") ~ 1,
(H1FV3 == "(1) (1) Once" |  H1FV3 == "(2) (2) More than once") ~ 1,
(H1FV4 == "(1) (1) Once" |  H1FV4 == "(2) (2) More than once") ~ 1,
(H1FV6 == "(1) (1) Once" |  H1FV6 == "(2) (2) More than once") ~ 1,
H1FV2 == "(0) (0) Never" ~ 0,
H1FV3 == "(0) (0) Never" ~ 0,
H1FV4 == "(0) (0) Never" ~ 0,
H1FV6 == "(0) (0) Never" ~ 0,
T ~ NA_real_))
#Dependent Variable Breakdown Table
mydata <- mydata %>%
mutate(knife.gun = case_when(
(H1FV2 == "(1) (1) Once" |  H1FV2 == "(2) (2) More than once") ~ 1,
H1FV2 == "(0) (0) Never" ~ 0,
T ~ NA_real_))
mydata <- mydata %>%
mutate(shot = case_when(
(H1FV3 == "(1) (1) Once" |  H1FV3 == "(2) (2) More than once") ~ 1,
H1FV3 == "(0) (0) Never" ~ 0,
T ~ NA_real_))
mydata <- mydata %>%
mutate(stabbed = case_when(
(H1FV4 == "(1) (1) Once" |  H1FV4 == "(2) (2) More than once") ~ 1,
H1FV4 == "(0) (0) Never" ~ 0,
T ~ NA_real_))
mydata <- mydata %>%
mutate(jumped = case_when(
(H1FV6 == "(1) (1) Once" |  H1FV6 == "(2) (2) More than once") ~ 1,
H1FV6 == "(0) (0) Never" ~ 0,
T ~ NA_real_))
#Creating the Network Delinquency Variable
mydata <- mydata %>%
mutate(network.delinquency = (AXS59A + AXS59B + AXS59C + AXS59D + AXS59E + AXS59F + AXS59G)/7)
#Cleaning Control Variables
mydata <- mydata %>%
mutate(female = case_when(
S2 == "(1) (1) Male" ~ 0,
S2 == "(2) (2) Female" ~ 1,
T ~ NA_real_))
mydata$age <- mydata$S1
mydata$family.income <- mydata$PA55
mydata <- mydata %>%
mutate(weapon.carry = case_when(
H1FV9 == "(0) (0) None (skip to Q.11)" ~ 0,
(H1FV9 == "(1) (1) 1 day" | H1FV9 == "(2) (2) 2 or 3 days" | H1FV9 == "(3) (3) 4 or 5 days" | H1FV9 == "(4) (4) 6 or more days") ~ 1,
T ~ NA_real_))
#Renaming Network Variables
mydata$racial.heterogeneity <- mydata$ERNRC5
mydata$dense <- mydata$ESRDEN
mydata$centrality <- mydata$BCENT10X
mydata$popularity <- mydata$IDGX2
mydata <- mydata %>%
mutate(den = case_when(
(popularity == 0 & centrality == 0) ~ 0,
T ~ dense))
mydata <- mydata %>%
mutate(density = den*100)
#Variable Selection
mydata.dv <- mydata %>%
select(knife.gun, shot, stabbed, jumped)
mydata <- mydata %>%
select(AID, victim, race, female, age, family.income, weapon.carry, racial.heterogeneity, network.delinquency, popularity, centrality, density)
#Only complete rows Kept
mydata.c <- mydata[complete.cases(mydata), ]
race.plot <- mydata.c %>%
filter(race != is.na(race)) %>%
ggplot(aes(x = race, fill = race)) +
geom_bar() + guides(fill = F) +
coord_flip() +
labs(title = "Racial Composition of Respondents", y = "Counts", x = " ") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.position = "none")
mu <- mean(mydata.c$victim)
mu <- round(mu, digits = 3)
race.victim <- mydata.c %>%
ggplot(aes(x = race)) +
geom_bar(aes(fill = as.character(victim)), position = "fill") + guides(fill = F) +
geom_hline(yintercept= mu, linetype = "dashed", color = "red3") + #can use annotate() to label the mean line
annotate("text", x = 8, y = 0.25, label = "Sample Mean", color = "red3", size = 1) +
coord_flip() +
labs(title = "Victimization by Race", y = "Proportion of Victims", x = " ") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.position = "none")
#Dependent Variable Breakdown Summary
Proportion <- sapply(mydata.dv, mean, na.rm = T)
cont1 <- length(which(mydata.dv$knife.gun == 1))
cont2 <- length(which(mydata.dv$shot == 1))
cont3 <- length(which(mydata.dv$stabbed == 1))
cont4 <- length(which(mydata.dv$jumped == 1))
conts <- c(cont1, cont2, cont3, cont4)
names <- c("knife.gun", "shot", "stabbed", "jumped")
Counts <- rbind(conts, names)
colnames(Counts) <- names
Counts <- Counts[-2,1:4]
Proportion <- round(Proportion, digits = 3)
t1 <- cbind(Proportion, Counts)
table1 <- kable(t1, "latex", caption = "Dependent Variable Index", booktabs = T) %>%
kable_styling(latex_options = "striped") %>%
footnote(general = "N = 3145")
#Creating the Summary Statistics
mydata.num <- mydata %>%
select(-AID, -race)
Mean <- sapply(mydata.num, mean, na.rm= T)
Stdv <- sapply(mydata.num, sd, na.rm = T)
Min <- sapply(mydata.num, min, na.rm = T)
Median <- sapply(mydata.num, median, na.rm = T)
Max <- sapply(mydata.num, max, na.rm = T)
t2 <- data.frame(
Items = c("Question 1","Question 2","Question 3","Question 4","Question 5","Question 6","Question 7"),
Features = c("During the past twelve months, how often did you smoke cigarettes?", "During the past twelve months, how often did you drink beer, wine, liqour?", "During the past twelve months, how often did you get drunk?", "During the past twelve months, how often did you race on a bike, skateboard, roller blades, or in a boat or car?", "During the past twelve months, how often did you do something dangerous because you were dared to?", "During the past twelve months, how often did you lie to your parents or guardians?", "During the past twelve months, how often did you skip school without an excuse?"))
table2 <- kable(t2, caption = "Friendship Network Delinquency Index" , "latex", booktabs = T) %>%
kable_styling(full_width = F) %>%
column_spec(1, bold = T) %>%
column_spec(2, width = "30em")
t3 <- round(cbind(Mean, Stdv, Min, Median, Max), digits=3)
table3 <- kable(t3, caption = "Descriptive Statistics","latex", booktabs = T) %>%
kable_styling(latex_options = "striped") %>%
footnote(general = "N = 3145")
a <- grid.arrange(race.plot, race.victim, nrow = 2, bottom = textGrob("Figure 1", x = .9, y = .5, gp = gpar(fontsize = 8)))
ggsave("race_plot.pdf", a, width = 25, height = 15, units = "cm")
race.plot <- mydata.c %>%
filter(race != is.na(race)) %>%
ggplot(aes(x = race, fill = race)) +
geom_bar() + guides(fill = F) +
coord_flip() +
labs(title = "Racial Composition of Respondents", y = "Counts", x = " ") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.position = "none")
mu <- mean(mydata.c$victim)
mu <- round(mu, digits = 3)
race.victim <- mydata.c %>%
ggplot(aes(x = race)) +
geom_bar(aes(fill = as.character(victim)), position = "fill") + guides(fill = F) +
geom_hline(yintercept= mu, linetype = "dashed", color = "red3") + #can use annotate() to label the mean line
annotate("text", x = 8, y = 0.25, label = "Sample Mean", color = "red3", size = 10) +
coord_flip() +
labs(title = "Victimization by Race", y = "Proportion of Victims", x = " ") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.position = "none")
#Dependent Variable Breakdown Summary
Proportion <- sapply(mydata.dv, mean, na.rm = T)
cont1 <- length(which(mydata.dv$knife.gun == 1))
cont2 <- length(which(mydata.dv$shot == 1))
cont3 <- length(which(mydata.dv$stabbed == 1))
cont4 <- length(which(mydata.dv$jumped == 1))
conts <- c(cont1, cont2, cont3, cont4)
names <- c("knife.gun", "shot", "stabbed", "jumped")
Counts <- rbind(conts, names)
colnames(Counts) <- names
Counts <- Counts[-2,1:4]
Proportion <- round(Proportion, digits = 3)
t1 <- cbind(Proportion, Counts)
table1 <- kable(t1, "latex", caption = "Dependent Variable Index", booktabs = T) %>%
kable_styling(latex_options = "striped") %>%
footnote(general = "N = 3145")
#Creating the Summary Statistics
mydata.num <- mydata %>%
select(-AID, -race)
Mean <- sapply(mydata.num, mean, na.rm= T)
Stdv <- sapply(mydata.num, sd, na.rm = T)
Min <- sapply(mydata.num, min, na.rm = T)
Median <- sapply(mydata.num, median, na.rm = T)
Max <- sapply(mydata.num, max, na.rm = T)
t2 <- data.frame(
Items = c("Question 1","Question 2","Question 3","Question 4","Question 5","Question 6","Question 7"),
Features = c("During the past twelve months, how often did you smoke cigarettes?", "During the past twelve months, how often did you drink beer, wine, liqour?", "During the past twelve months, how often did you get drunk?", "During the past twelve months, how often did you race on a bike, skateboard, roller blades, or in a boat or car?", "During the past twelve months, how often did you do something dangerous because you were dared to?", "During the past twelve months, how often did you lie to your parents or guardians?", "During the past twelve months, how often did you skip school without an excuse?"))
table2 <- kable(t2, caption = "Friendship Network Delinquency Index" , "latex", booktabs = T) %>%
kable_styling(full_width = F) %>%
column_spec(1, bold = T) %>%
column_spec(2, width = "30em")
t3 <- round(cbind(Mean, Stdv, Min, Median, Max), digits=3)
table3 <- kable(t3, caption = "Descriptive Statistics","latex", booktabs = T) %>%
kable_styling(latex_options = "striped") %>%
footnote(general = "N = 3145")
a <- grid.arrange(race.plot, race.victim, nrow = 2, bottom = textGrob("Figure 1", x = .9, y = .5, gp = gpar(fontsize = 8)))
ggsave("race_plot.pdf", a, width = 25, height = 15, units = "cm")
race.plot <- mydata.c %>%
filter(race != is.na(race)) %>%
ggplot(aes(x = race, fill = race)) +
geom_bar() + guides(fill = F) +
coord_flip() +
labs(title = "Racial Composition of Respondents", y = "Counts", x = " ") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.position = "none")
mu <- mean(mydata.c$victim)
mu <- round(mu, digits = 3)
race.victim <- mydata.c %>%
ggplot(aes(x = race)) +
geom_bar(aes(fill = as.character(victim)), position = "fill") + guides(fill = F) +
geom_hline(yintercept= mu, linetype = "dashed", color = "red3") + #can use annotate() to label the mean line
annotate("text", x = 8, y = 0.25, label = "Sample Mean", color = "red3", size = 3) +
coord_flip() +
labs(title = "Victimization by Race", y = "Proportion of Victims", x = " ") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.position = "none")
#Dependent Variable Breakdown Summary
Proportion <- sapply(mydata.dv, mean, na.rm = T)
cont1 <- length(which(mydata.dv$knife.gun == 1))
cont2 <- length(which(mydata.dv$shot == 1))
cont3 <- length(which(mydata.dv$stabbed == 1))
cont4 <- length(which(mydata.dv$jumped == 1))
conts <- c(cont1, cont2, cont3, cont4)
names <- c("knife.gun", "shot", "stabbed", "jumped")
Counts <- rbind(conts, names)
colnames(Counts) <- names
Counts <- Counts[-2,1:4]
Proportion <- round(Proportion, digits = 3)
t1 <- cbind(Proportion, Counts)
table1 <- kable(t1, "latex", caption = "Dependent Variable Index", booktabs = T) %>%
kable_styling(latex_options = "striped") %>%
footnote(general = "N = 3145")
#Creating the Summary Statistics
mydata.num <- mydata %>%
select(-AID, -race)
Mean <- sapply(mydata.num, mean, na.rm= T)
Stdv <- sapply(mydata.num, sd, na.rm = T)
Min <- sapply(mydata.num, min, na.rm = T)
Median <- sapply(mydata.num, median, na.rm = T)
Max <- sapply(mydata.num, max, na.rm = T)
t2 <- data.frame(
Items = c("Question 1","Question 2","Question 3","Question 4","Question 5","Question 6","Question 7"),
Features = c("During the past twelve months, how often did you smoke cigarettes?", "During the past twelve months, how often did you drink beer, wine, liqour?", "During the past twelve months, how often did you get drunk?", "During the past twelve months, how often did you race on a bike, skateboard, roller blades, or in a boat or car?", "During the past twelve months, how often did you do something dangerous because you were dared to?", "During the past twelve months, how often did you lie to your parents or guardians?", "During the past twelve months, how often did you skip school without an excuse?"))
table2 <- kable(t2, caption = "Friendship Network Delinquency Index" , "latex", booktabs = T) %>%
kable_styling(full_width = F) %>%
column_spec(1, bold = T) %>%
column_spec(2, width = "30em")
t3 <- round(cbind(Mean, Stdv, Min, Median, Max), digits=3)
table3 <- kable(t3, caption = "Descriptive Statistics","latex", booktabs = T) %>%
kable_styling(latex_options = "striped") %>%
footnote(general = "N = 3145")
a <- grid.arrange(race.plot, race.victim, nrow = 2, bottom = textGrob("Figure 1", x = .9, y = .5, gp = gpar(fontsize = 8)))
ggsave("race_plot.pdf", a, width = 25, height = 15, units = "cm")
race.plot <- mydata.c %>%
filter(race != is.na(race)) %>%
ggplot(aes(x = race, fill = race)) +
geom_bar() + guides(fill = F) +
coord_flip() +
labs(title = "Racial Composition of Respondents", y = "Counts", x = " ") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.position = "none")
mu <- mean(mydata.c$victim)
mu <- round(mu, digits = 3)
race.victim <- mydata.c %>%
ggplot(aes(x = race)) +
geom_bar(aes(fill = as.character(victim)), position = "fill") + guides(fill = F) +
geom_hline(yintercept= mu, linetype = "dashed", color = "red3") + #can use annotate() to label the mean line
annotate("text", x = 8, y = 0.26, label = "Sample Mean", color = "red3", size = 3) +
coord_flip() +
labs(title = "Victimization by Race", y = "Proportion of Victims", x = " ") +
scale_colour_pander() +
scale_fill_pander() +
theme_pander() +
theme(text = element_text(family = "Times"), plot.title = element_text(hjust = 0.5), legend.position = "none")
#Dependent Variable Breakdown Summary
Proportion <- sapply(mydata.dv, mean, na.rm = T)
cont1 <- length(which(mydata.dv$knife.gun == 1))
cont2 <- length(which(mydata.dv$shot == 1))
cont3 <- length(which(mydata.dv$stabbed == 1))
cont4 <- length(which(mydata.dv$jumped == 1))
conts <- c(cont1, cont2, cont3, cont4)
names <- c("knife.gun", "shot", "stabbed", "jumped")
Counts <- rbind(conts, names)
colnames(Counts) <- names
Counts <- Counts[-2,1:4]
Proportion <- round(Proportion, digits = 3)
t1 <- cbind(Proportion, Counts)
table1 <- kable(t1, "latex", caption = "Dependent Variable Index", booktabs = T) %>%
kable_styling(latex_options = "striped") %>%
footnote(general = "N = 3145")
#Creating the Summary Statistics
mydata.num <- mydata %>%
select(-AID, -race)
Mean <- sapply(mydata.num, mean, na.rm= T)
Stdv <- sapply(mydata.num, sd, na.rm = T)
Min <- sapply(mydata.num, min, na.rm = T)
Median <- sapply(mydata.num, median, na.rm = T)
Max <- sapply(mydata.num, max, na.rm = T)
t2 <- data.frame(
Items = c("Question 1","Question 2","Question 3","Question 4","Question 5","Question 6","Question 7"),
Features = c("During the past twelve months, how often did you smoke cigarettes?", "During the past twelve months, how often did you drink beer, wine, liqour?", "During the past twelve months, how often did you get drunk?", "During the past twelve months, how often did you race on a bike, skateboard, roller blades, or in a boat or car?", "During the past twelve months, how often did you do something dangerous because you were dared to?", "During the past twelve months, how often did you lie to your parents or guardians?", "During the past twelve months, how often did you skip school without an excuse?"))
table2 <- kable(t2, caption = "Friendship Network Delinquency Index" , "latex", booktabs = T) %>%
kable_styling(full_width = F) %>%
column_spec(1, bold = T) %>%
column_spec(2, width = "30em")
t3 <- round(cbind(Mean, Stdv, Min, Median, Max), digits=3)
table3 <- kable(t3, caption = "Descriptive Statistics","latex", booktabs = T) %>%
kable_styling(latex_options = "striped") %>%
footnote(general = "N = 3145")
a <- grid.arrange(race.plot, race.victim, nrow = 2, bottom = textGrob("Figure 1", x = .9, y = .5, gp = gpar(fontsize = 8)))
ggsave("race_plot.pdf", a, width = 25, height = 15, units = "cm")
library(tidyverse)
library(dplyr)
library(gridExtra)
library(grid)
library(rethinking)
library(kableExtra)
library(ggthemes)
library(knitr)
library(broom)
library(brms)
library(loo)
#Windows
#load("E:/Repository/Biso/Biso/data/wave1.rda")
#load("E:/Repository/Biso/Biso/data/network.wave1.rda")
#load("E:/Repository/Biso/Biso/data/weights.rda")
#Mac
load("~/desktop/Repository/Biso/data/wave1.rda")
load("~/desktop/Repository/Biso/data/network.wave1.rda")
load("~/desktop/Repository/Biso/data/weights.rda")
#Renamed
wave1.data <- da21600.0001
network.data <- da21600.0003
weights <- da21600.0004
#Merging Relevant Variables into one Data Frame
data1 <- wave1.data %>%
dplyr :: select(AID, H1FV2, H1FV3, H1FV4, H1FV6, S6A, S6B, S6C, S6D, S6E, S4, S1, S2, PA55, H1FV9)
data2 <-  network.data %>%
dplyr :: select(AID, ESRDEN, BCENT10X, IDGX2, SEG1RCE5, ERNRC5, EHRC5, AXS59A, AXS59B, AXS59C, AXS59D, AXS59E, AXS59F, AXS59G, SRCE51, SRCE52, SRCE53, SRCE54, SRCE55)
data3 <- weights %>%
dplyr :: select(AID, GSWGT1)
mydata <- merge(data1, data2, by = "AID")
#mydata <- merge(my.data, data3, by = "AID")
#Race variable
mydata <- mydata %>%
mutate(race = case_when(
(S4 == "(1) (1) Yes (go to Q.5)" & S6A == "(1) (1) Marked") ~ "white latino",
(S4 == "(1) (1) Yes (go to Q.5)" & S6B == "(1) (1) Marked") ~ "black latino",
(S6A == "(1) (1) Marked" & S6B== "(1) (1) Marked") ~ "mixed race",
(S6A == "(1) (1) Marked" & S6C == "(1) (1) Marked") ~ "mixed race",
(S6A == "(1) (1) Marked" & S6D == "(1) (1) Marked") ~ "mixed race",
(S6A == "(1) (1) Marked" & S6E == "(1) (1) Marked") ~ "mixed race",
(S6B == "(1) (1) Marked" & S6C == "(1) (1) Marked") ~ "mixed race",
(S6B == "(1) (1) Marked" & S6D == "(1) (1) Marked") ~ "mixed race",
(S6B == "(1) (1) Marked" & S6E == "(1) (1) Marked") ~ "mixed race",
(S6C == "(1) (1) Marked" & S6D == "(1) (1) Marked") ~ "mixed race",
(S6C == "(1) (1) Marked" & S6E == "(1) (1) Marked") ~ "mixed race",
(S6D == "(1) (1) Marked" & S6E == "(1) (1) Marked") ~ "mixed race",
S4 == "(1) (1) Yes (go to Q.5)" ~ "latino",
S6A == "(1) (1) Marked" ~ "white",
S6B == "(1) (1) Marked" ~ "black",
S6C == "(1) (1) Marked" ~ "asian",
S6D == "(1) (1) Marked" ~ "native american",
S6E == "(1) (1) Marked" ~ "other",
T ~ NA_character_))
#Victimization
mydata <- mydata %>%
mutate(victim = case_when(
(H1FV2 == "(1) (1) Once" |  H1FV2 == "(2) (2) More than once") ~ 1,
(H1FV3 == "(1) (1) Once" |  H1FV3 == "(2) (2) More than once") ~ 1,
(H1FV4 == "(1) (1) Once" |  H1FV4 == "(2) (2) More than once") ~ 1,
(H1FV6 == "(1) (1) Once" |  H1FV6 == "(2) (2) More than once") ~ 1,
H1FV2 == "(0) (0) Never" ~ 0,
H1FV3 == "(0) (0) Never" ~ 0,
H1FV4 == "(0) (0) Never" ~ 0,
H1FV6 == "(0) (0) Never" ~ 0,
T ~ NA_real_))
#Dependent Variable Breakdown Table
mydata <- mydata %>%
mutate(knife.gun = case_when(
(H1FV2 == "(1) (1) Once" |  H1FV2 == "(2) (2) More than once") ~ 1,
H1FV2 == "(0) (0) Never" ~ 0,
T ~ NA_real_))
mydata <- mydata %>%
mutate(shot = case_when(
(H1FV3 == "(1) (1) Once" |  H1FV3 == "(2) (2) More than once") ~ 1,
H1FV3 == "(0) (0) Never" ~ 0,
T ~ NA_real_))
mydata <- mydata %>%
mutate(stabbed = case_when(
(H1FV4 == "(1) (1) Once" |  H1FV4 == "(2) (2) More than once") ~ 1,
H1FV4 == "(0) (0) Never" ~ 0,
T ~ NA_real_))
mydata <- mydata %>%
mutate(jumped = case_when(
(H1FV6 == "(1) (1) Once" |  H1FV6 == "(2) (2) More than once") ~ 1,
H1FV6 == "(0) (0) Never" ~ 0,
T ~ NA_real_))
#Creating the Network Delinquency Variable
mydata <- mydata %>%
mutate(network.delinquency = (AXS59A + AXS59B + AXS59C + AXS59D + AXS59E + AXS59F + AXS59G)/7)
#Cleaning Control Variables
mydata <- mydata %>%
mutate(female = case_when(
S2 == "(1) (1) Male" ~ 0,
S2 == "(2) (2) Female" ~ 1,
T ~ NA_real_))
mydata$age <- mydata$S1
mydata$family.income <- mydata$PA55
mydata <- mydata %>%
mutate(weapon.carry = case_when(
H1FV9 == "(0) (0) None (skip to Q.11)" ~ 0,
(H1FV9 == "(1) (1) 1 day" | H1FV9 == "(2) (2) 2 or 3 days" | H1FV9 == "(3) (3) 4 or 5 days" | H1FV9 == "(4) (4) 6 or more days") ~ 1,
T ~ NA_real_))
#Renaming Network Variables
mydata$racial.heterogeneity <- mydata$ERNRC5
mydata$dense <- mydata$ESRDEN
mydata$centrality <- mydata$BCENT10X
mydata$popularity <- mydata$IDGX2
mydata <- mydata %>%
mutate(den = case_when(
(popularity == 0 & centrality == 0) ~ 0,
T ~ dense))
mydata <- mydata %>%
mutate(density = den*100)
#Variable Selection
mydata.dv <- mydata %>%
select(knife.gun, shot, stabbed, jumped)
mydata <- mydata %>%
select(AID, victim, race, female, age, family.income, weapon.carry, racial.heterogeneity, network.delinquency, popularity, centrality, density)
#Only complete rows Kept
mydata.c <- mydata[complete.cases(mydata), ]
View(mydata)
